package archenoah.web.normal.main.Menuepunkte.Individuelle.Ordermanager.TicketPreferences.form;

import java.text.DateFormat;
import java.util.ArrayList;

import org.tepi.filtertable.FilterTable;

import archenoah.config.CMS_Config_Std;
import archenoah.lib.tool.comunication.dbclass.DBClass;
import archenoah.lib.vaadin.Components.ClickMenuBar.ClickCommand;
import archenoah.lib.vaadin.Components.Window_Tab_Generierer.Build_Tab_Menue_Item;
import archenoah.lib.vaadin.Components.Window_Tab_Generierer.Build_Window_Button;
import archenoah.lib.vaadin.Components.table.FilteringTableUpdater;
import archenoah.lib.vaadin.CustomConverterFactorys.BooleanToTextConverter;
import archenoah.lib.vaadin.CustomConverterFactorys.DayOfWeekConverter;
import archenoah.lib.vaadin.CustomConverterFactorys.StringSqlTimestampConverter;
import archenoah.lib.vaadin.Language.i18n.I18nConverter;
import archenoah.lib.vaadin.Language.i18n.I18nGlobalMessages;
import archenoah.lib.vaadin.Language.i18n.I18nGlobalNotifiers;
import archenoah.lib.vaadin.Language.i18n.I18nManager;
import archenoah.lib.vaadin.MenuBerechtigung.Rechteholen;
import archenoah.lib.vaadin.resources.Icons;
import archenoah.web.normal.main.Menuepunkte.Individuelle.Ordermanager.TicketPreferences.classes.LngLocationTypeConverter;

import com.vaadin.annotations.AutoGenerated;
import com.vaadin.data.Container;
import com.vaadin.data.util.converter.Converter;
import com.vaadin.event.UIEvents.PollEvent;
import com.vaadin.event.UIEvents.PollListener;
import com.vaadin.server.ThemeResource;
import com.vaadin.ui.AbstractField;
import com.vaadin.ui.Alignment;
import com.vaadin.ui.Button;
import com.vaadin.ui.CustomComponent;
import com.vaadin.ui.HorizontalLayout;
import com.vaadin.ui.MenuBar;
import com.vaadin.ui.MenuBar.Command;
import com.vaadin.ui.MenuBar.MenuItem;
import com.vaadin.ui.TabSheet;
import com.vaadin.ui.UI;
import com.vaadin.ui.VerticalLayout;
import com.vaadin.ui.Window;

import de.steinwedel.messagebox.ButtonId;
import de.steinwedel.messagebox.MessageBoxListener;


@SuppressWarnings({"serial", "rawtypes"})
public class TicketPreferencesDataView extends CustomComponent {

    /*- VaadinEditorProperties={"grid":"RegularGrid,20","showGrid":true,"snapToGrid":true,"snapToObject":true,"movingGuides":false,"snappingDistance":10} */

    @AutoGenerated
	private HorizontalLayout mainLayout;

	@AutoGenerated
	private VerticalLayout vl_main;

	@AutoGenerated
	private FilterTable tbl_data;

	@AutoGenerated
	private VerticalLayout vl_menuSpacer;

	@AutoGenerated
	private MenuBar men_frm;

	

    /**
     * The constructor should first build the main layout, set the composition
     * root and then do any custom initialization.
     * 
     * The constructor will not be automatically regenerated by the visual
     * editor.
     */

    /**************** --> Allgemein <--- ********************/
    // Datenbank
    private FilteringTableUpdater tableUpdater = null;

    // Berrechtigung
    private int ACC_ID;

    private int permRead;
    private int permCreate;
    private int permUpdate;
    private int permDelete;

    private MenuItem tmpMenu = null;

    private Button tmpButton = null;
    /******************************************************/
    /**************** --> Tabsheetvars <--- *****************/
    private TabSheet tab = null;

    /******************************************************/
    /**************** --> Windowvars <--- *******************/
    private Window win = null;
    /******************************************************/

    private DetachListener onDetach = null;

    /******************* -> Menüpunkte <- ********************/
    private MenuBar.MenuItem btn_create;
    private MenuBar.MenuItem btn_update;
    private MenuBar.MenuItem btn_read;
    private MenuBar.MenuItem btn_delete;
    private MenuBar.MenuItem btn_filter;

    
    /*******************************************************/
    /******************* --> Custom <--- ********************/
    /******************************************************/

    private Boolean firstFilter = true;
    private PollListener pollListener = null;
    
    enum Status {}
    
    private Integer nurseUserId = 0;
    
    /************ ----->Einstellungen<-- ********************/
//    private final String formIdLng = "103"; //TASK Set ID
    private final String formIdPerm = "103";//TASK Set ID
    private final String winHeight = "600px";
    private final String winWidth = "900px";


    /******************************************************/

    private final String tableIdCol = "OMPR_ID";
    
    private final Object[] tableColsAll = new Object[] { "OMPR_ID", "OMPR_ID_USER",  "OMPR_CREATED", "OMPR_UPDATED", 
    		"KSK_COUNTRYCODE", "nurse_name", "OMPR_DAYOFWEEK", "OMMTL_TEXT", "OMPR_USE_CUSTOM_LOCATION" , "ST_TYPE",
    		"name", "extended", "street" , "plz", "city"};
    //use custom Cols when needed
    private final Object[] tableColsDefault = tableColsAll;
    //use custom Cols when needed
    private final Object[] tableColsFilter = tableColsDefault;
    private Object[] tableColsActive = tableColsDefault;

    private I18nManager i18n;

    /******************************************************/

    public TicketPreferencesDataView(MenuItem Arg_Menü) {
        tmpMenu = Arg_Menü;
    }

    public TicketPreferencesDataView(Button Arg_btn) {
        tmpButton = Arg_btn;
    }

    /***************************** ---> Feste Funtionen<--- **************************************/

    /********* INIT-Window ************/
    public void init() {

        Standard_Init();

        if (tmpMenu != null) {
            String Recourcename = tmpMenu.getIcon().toString();
            Recourcename = Recourcename.substring(0, Recourcename.length() - 12) + "white-16.png";

            Build_Window_Button bwb = new Build_Window_Button(tmpMenu.getText(), mainLayout, winHeight, winWidth,
                    new ThemeResource(Recourcename));
            win = bwb.ReturnWindow();
        }
        if (tmpButton != null) {
            Build_Window_Button bwb = new Build_Window_Button(tmpButton.getCaption(), mainLayout, winHeight, winWidth,
                    tmpButton.getIcon());
            win = bwb.ReturnWindow();
        }

        win.addDetachListener(onDetach);

    }
    
    public Window getWindow(){
    	return win;
    }
    
    public TabSheet getTabSheet(){
    	return tab;
    }
    
    public void init(TabSheet Arg_tab) {

        Standard_Init();
        tab = Arg_tab;
        if (tmpMenu != null) {
            new Build_Tab_Menue_Item(Arg_tab, tmpMenu.getText(), mainLayout, tmpMenu.getIcon());
        }
        if (tmpButton != null) {
            new Build_Tab_Menue_Item(Arg_tab, tmpButton.getCaption(), mainLayout, tmpButton.getIcon());
        }

        tab.getSelectedTab().addDetachListener(onDetach);
    }

    /********* Init-Standard ************/
    private void Standard_Init() {
        buildMainLayout();
        i18n = new I18nManager(this);

        generateMenu();

        setNurseUserId();
        
        setMenuPermissions();

        updateTable();
        tbl_data.setSortContainerPropertyId(tableIdCol);
        tbl_data.setSortAscending(true);
        tbl_data.sort();
        configureTable();
        configueComponents();
                
        updateTable();
        
        setupListenersAndDetachEvent();
        i18n.refresh();
    }

    private void setupListenersAndDetachEvent() {
        pollListener = new PollListener() {

            @Override
            public void poll(PollEvent event) {
                if(tab.isRendered(mainLayout)){
                    updateTable();
                }
            }
        };

        UI.getCurrent().getUI().addPollListener(pollListener);

        onDetach = new DetachListener() {

            @Override
            public void detach(DetachEvent event) {
                UI.getCurrent().getUI().removePollListener(pollListener);
            }
        };
    }
    
    
    @SuppressWarnings("unused")
    public void setPermissionsFromDatabase() {
        if (formIdPerm == "") {
            System.out.println("Form Einstellung Fehlt: Berechtigung");
            return;
        }

        ACC_ID = (int) UI.getCurrent().getSession().getSession().getAttribute("Userid");
        Rechteholen r = new Rechteholen(ACC_ID + "");
        String[][] perms = r.Datenholen();

        for (int i = 0; i < perms.length; i++) {
            if (perms[i][0].equals(formIdPerm) == true) {

                permRead = Integer.valueOf(perms[i][3]);
                permUpdate = Integer.valueOf(perms[i][4]);
                permCreate = Integer.valueOf(perms[i][6]);
                permDelete = Integer.valueOf(perms[i][5]);
                
            }
        }
    }

    public void setPermissions(int create, int read, int update, int delete) {

        permCreate = create;
        permRead = read;
        permUpdate = update;
        permDelete = delete;

    }

    private void setMenuPermissions() {
        Boolean c = (permCreate == 1);
        Boolean r = (permRead == 1);
        Boolean u = (permUpdate == 1);
        Boolean d = (permDelete == 1);

        btn_create.setEnabled(c);
        btn_create.setVisible(c);

        btn_read.setEnabled(r);
        btn_read.setVisible(r);

        btn_update.setEnabled(u);
        btn_update.setVisible(u);

        btn_delete.setEnabled(d);
        btn_delete.setVisible(d);
    }

    /************ -><- ******************/

    /***************** Comands *********************/
    
    private String getSelectedId(){
    	return Integer.toString((Integer) tbl_data.getContainerProperty(tbl_data.getValue(), tableIdCol).getValue());
    }
    
    //TASK Commands are here
    public ClickCommand cmd_btn_add = new ClickCommand() {
        @Override
        public void menuClicked(MenuItem selectedItem) {

        	TicketPreferencesInsertEdit pie = new TicketPreferencesInsertEdit(selectedItem, "");
            pie.setPermissions(permCreate, permRead, permUpdate, permDelete);
        	pie.init();
        	this.setParent(men_frm);
        	this.setWindow(pie.getWindow());
            
        }
    };
    
    public ClickCommand cmd_btn_read = new ClickCommand() {
        @Override
        public void menuClicked(MenuItem selectedItem) {

            if(tbl_data.getValue() == null){
                I18nManager.global(I18nGlobalNotifiers.no_entry_selected);
                return;
            }
            
            TicketPreferencesInsertEdit pie = new TicketPreferencesInsertEdit(selectedItem, getSelectedId());
            pie.setPermissions(0, permRead, 0, 0);
//            pie.setPermissions(permCreate, permRead, permUpdate, permDelete);
        	pie.init();
        	this.setParent(men_frm);
        	this.setWindow(pie.getWindow());

        }
    };
    
    public ClickCommand cmd_btn_edit = new ClickCommand() {
        @Override
        public void menuClicked(MenuItem selectedItem) {
            
            if(tbl_data.getValue() == null){
                I18nManager.global(I18nGlobalNotifiers.no_entry_selected);
                return;
            }
            
            TicketPreferencesInsertEdit pie = new TicketPreferencesInsertEdit(selectedItem, getSelectedId());
            pie.setPermissions(permCreate, permRead, permUpdate, permDelete);
        	pie.init();
        	this.setParent(men_frm);
        	this.setWindow(pie.getWindow());

        }
    };

    public Command cmd_btn_del = new Command() {
        @Override
        public void menuSelected(MenuItem selectedItem) {
            
            if(tbl_data.getValue() == null){
                I18nManager.global(I18nGlobalNotifiers.no_entry_selected);
                return;
            }
            
            deleteData(getSelectedId());

        }
    };

    public Command cmd_btn_filter = new Command() {
        @Override
        public void menuSelected(MenuItem selectedItem) {

            if (firstFilter) {
                tbl_data.setFilterBarVisible(true);
                tbl_data.setFilterBarVisible(false);
                firstFilter = false;
            }
            tbl_data.setFilterBarVisible(!tbl_data.isFilterBarVisible());
            
            if(!tbl_data.isFilterBarVisible()){
                tbl_data.clearFilters();
            }
            
            tableColsActive = tbl_data.isFilterBarVisible() ? tableColsFilter : tableColsDefault;
            tbl_data.setVisibleColumns(tableColsActive);

        }
    };
    

    /******************************************/

    
    

    /*********** Gen Menüs *************/
    private void generateMenu() {

        btn_create = men_frm.addItem("FRM_ADD", Icons.White.add_16, cmd_btn_add);
        btn_update = men_frm.addItem("FRM_EDIT", Icons.White.edit_16, cmd_btn_edit);
        btn_read = men_frm.addItem("FRM_READ", Icons.White.perm_lesen_16, cmd_btn_read);
        btn_delete = men_frm.addItem("FRM_DEL", Icons.White.delete_16, cmd_btn_del);
        
        btn_filter = men_frm.addItem("FRM_FILTER", Icons.White.filter_16, cmd_btn_filter);

    }
    
    private void setNurseUserId(){
        nurseUserId = getNurseUID();
    }
    
    private void configueComponents(){
       
    	
        
        
    }
    
    
    private ArrayList<AbstractField> getActiveGlobalFilters(){
        ArrayList<AbstractField> al = new ArrayList<AbstractField>();
        
//        if(pop_month.getValue() != null){
//            al.add(pop_month);
//        }
//        
//        if(cb_filterStatus.getValue()){
//            al.add(tcol_filterStatus);
//        }
        
        return al;
    }
    
    private Boolean hasGlobalFilters(ArrayList a){
        
        return (a.size() > 0);
        
    }
    
    private Boolean hasGlobalFilters(){
        
        return hasGlobalFilters(getActiveGlobalFilters());
        
    }
    
    /*************************** Config TBL ********************/

    private void configureTable() {
        tbl_data.setSelectable(true);
        tbl_data.setFilterOnDemand(false);
        tbl_data.setImmediate(true);
        tbl_data.setColumnCollapsingAllowed(false);
        tbl_data.setFooterVisible(true);
        tbl_data.setPageLength(1);
        
        Converter<String, Object> typeConverter = new LngLocationTypeConverter();
        tbl_data.setConverter("ST_TYPE", typeConverter);
        
        Converter<String, Integer> dayConverter = new DayOfWeekConverter();
        tbl_data.setConverter("OMPR_DAYOFWEEK", dayConverter);
        
        Converter<String, Object> freqConverter = new I18nConverter("cust_ordermanager_master_ticket_length", "OMMTL_TEXT");
        tbl_data.setConverter("OMMTL_TEXT", freqConverter);
        
        Converter<String, Boolean> boolConverter = new BooleanToTextConverter();
        tbl_data.setConverter("OMPR_USE_CUSTOM_LOCATION", boolConverter);
        
        StringSqlTimestampConverter date = new StringSqlTimestampConverter();
        date.setDateFormat(DateFormat.SHORT);
        tbl_data.setConverter("OMPR_CREATED", date);
        tbl_data.setConverter("OMPR_UPDATED", date);
        
        
        tableUpdater = new FilteringTableUpdater(tbl_data);
        
        for (Object col : tableColsAll) {
        	try {
        		tbl_data.setColumnExpandRatio(col, 1);
			} catch (Exception e) {

			}
		}
        
        tbl_data.setColumnExpandRatio("OMPR_ID", 0);
        tbl_data.setColumnExpandRatio("OMPR_ID_USER", 0);
        
        tbl_data.setColumnExpandRatio("ST_TYPE", 1.5f);
        tbl_data.setColumnExpandRatio("OMPR_CREATED", 1.2f);
        tbl_data.setColumnExpandRatio("OMPR_UPDATED", 1.2f);
        
        tbl_data.setColumnExpandRatio("nurse_name", 3);
        tbl_data.setColumnExpandRatio("name", 3);
        tbl_data.setColumnExpandRatio("street", 4);
        tbl_data.setColumnExpandRatio("city", 3);
        
        
        
    }
    /*************************** Database ********************/
    
    /********************************/
    
    
    private void updateTable(){
        updateTable(false);
    }
    
    private void updateTable(Boolean ignoreFilter) {

        if (ignoreFilter || !tbl_data.isFilterBarVisible()) {
            dbGetContainer();
            try{
                tbl_data.setVisibleColumns(tableColsActive);
            }catch(Exception e){

            }
        }
        
        tbl_data.setColumnFooter("Status", "Σ " + tbl_data.size());
        
    }
    
    private void deleteData(final String id){
        
        I18nManager.global(I18nGlobalMessages.confirm_delete, new MessageBoxListener() {
            
            @Override
            public void buttonClicked(ButtonId arg0) {
                if(ButtonId.YES == arg0) {
                    dbDeleteData(id);
                }
            }
        });
    }
    
    @SuppressWarnings("deprecation")
	private void dbGetContainer() {
        CMS_Config_Std std = CMS_Config_Std.getInstance();

        DBClass db = new DBClass();

        
        String nurseFilter = "";
        
        if(nurseUserId != 0){
        	nurseFilter = "WHERE cms_auth_stammdaten_user.AUL_ID = " + nurseUserId;
        }
        
        /************ Set Query *************/
        
        db.CustomQuery.setSqlString(
        		"SELECT *\n"
        		+ ", CONCAT(ASA_NAME, ' ', AUL_VORNAME, ' ', AUL_NAME) as nurse_name\n"
        		+ "FROM \n"
        		+ "	cust_ordermanager_preferences LEFT JOIN \n"
        		+ "	(\n"
        		+ "		SELECT * FROM (\n"

        		+ "			(SELECT\n"
        		+ "				SL_ID as id,\n"
        		+ "				null as user,\n"
        		+ "				SL_NAME as name,\n"
        		+ "				SL_EXTENDED as extended,\n"
        		+ "				SL_STREET as street,\n"
        		+ "				SL_PLZ as plz,\n"
        		+ "				SL_CITY as city,\n"
        		+ "				SL_ID_TYPE as type,\n"
        		+ "				1 as custom\n"
        		+ "			FROM \n"
        		+ "				cust_shipping_locations)\n"
        		+ "				\n"
        		+ "			UNION DISTINCT\n"
        		+ "		\n"
        		+ "			(SELECT\n"
        		+ "				null as id,\n"
        		+ "				AUL_ID as user,\n"
        		+ "				CONCAT(ASA_NAME, ' ', AUL_VORNAME, ' ', AUL_NAME) as name,\n"
        		+ "				null as extended,\n"
        		+ "				KSK_STRASSE as street,\n"
        		+ "				KSK_PLZ as plz,\n"
        		+ "				KSK_ORT as city,\n"
        		+ "				2 as type,\n"
        		+ "				0 as custom\n"
        		+ "				\n"
        		+ "			FROM cust_krankenschwester_stammdaten_ks\n"
        		+ "			INNER JOIN cms_auth_stammdaten_user on cust_krankenschwester_stammdaten_ks.KSK_U_ID = cms_auth_stammdaten_user.AUL_ID\n"
        		+ "			INNER JOIN cms_auth_stammdaten_anrede ON cms_auth_stammdaten_user.AUL_ANREDE_ID = cms_auth_stammdaten_anrede.ASA_ID)\n"

        		+ "		) as locationsUnion\n"

        		+ "	) as locations ON \n"
        		+ " cust_ordermanager_preferences.OMPR_USE_CUSTOM_LOCATION = locations.custom\n"
        		+ " AND (\n"
         		+ "	(cust_ordermanager_preferences.OMPR_ID_LOCATION = locations.id)\n"
          		+ "	OR\n"
          		+ "	(cust_ordermanager_preferences.OMPR_ID_USER = locations.user)\n"
          		+ " )\n"

				+ " INNER JOIN cms_auth_stammdaten_user on cust_ordermanager_preferences.OMPR_ID_USER = cms_auth_stammdaten_user.AUL_ID\n"
				+ " INNER JOIN cust_krankenschwester_stammdaten_ks on cms_auth_stammdaten_user.AUL_ID = cust_krankenschwester_stammdaten_ks.KSK_U_ID\n"
				+ " LEFT JOIN cms_auth_stammdaten_anrede ON cms_auth_stammdaten_user.AUL_ANREDE_ID = cms_auth_stammdaten_anrede.ASA_ID\n"
        		
        		+ "	LEFT JOIN cust_shipping_types ON cust_shipping_types.ST_ID = locations.type \n"
        		+ "	LEFT JOIN cust_ordermanager_master_ticket_length ON cust_ordermanager_master_ticket_length.OMMTL_VALUE = OMPR_TICKET_LENGTH\n"
        		+ " " + nurseFilter);
        
        /**************************************/
        /************ Set Filter *************/
//        String glue = "";
//        
//        
//        ArrayList<AbstractField> filterList = getActiveGlobalFilters(); 
//        
//        if(pop_month.getValue() != null){
//            
//           filterList.remove(pop_month);
//            glue = hasGlobalFilters(filterList) ? "AND" : "";
//            
//            db.DB_Data_Get.DB_Filter.DB_WHERE_BETWEEN(.., glue);
//        }
        
        
        
        /**************************************/
        /************ Set Custom *************/
        /**************************************/

//        db.DB_Data_Get.Set_Type("Status", Status.class);
        
        /* **************************/
        
//        db.debugNextQuery(true); 
        Container container = db.CustomQuery.query();

        if (tableUpdater != null) {
            tableUpdater.updateTable(container);
        } else {
            tbl_data.setContainerDataSource(container);
        }

    }
    
    private void dbDeleteData(String id){
    
        CMS_Config_Std std = CMS_Config_Std.getInstance();
    
        DBClass db = new DBClass();
        db.DB_Data_Delete.DB_Tabellen.DB_set_Tabelle_Einzeln("cust_ordermanager_preferences");
        db.DB_Data_Delete.DB_Filter.DB_WHERE_Allgemein("cust_ordermanager_preferences", "OMPR_ID", "=", id, "");
        db.DB_Data_Delete.DB_Delete();
    
        I18nManager.global(I18nGlobalNotifiers.entry_deleted);
        
        updateTable(true);

        
    }
    
    private int getNurseUID() {
        int UID = (int) UI.getCurrent().getSession().getSession().getAttribute("Userid");
        CMS_Config_Std std = CMS_Config_Std.getInstance();
        DBClass db = new DBClass();

        db.DB_Data_Get.DB_Spalten.Standard.DB_set_Spalten_All();
        db.DB_Data_Get.DB_Tabellen.DB_set_Tabelle_Einzeln("cms_auth_liste_gu");
        // db.DB_Data_Get.DB_Tabellen.DB_set_Tabelle_Verknüpfung("cms_auth_liste_gu",
        // "INNER JOIN", "cust_krankenschwester_stammdaten_ks", "AL_U_ID",
        // "KSK_U_ID");
        db.DB_Data_Get.DB_Filter.DB_WHERE_Allgemein("cms_auth_liste_gu", "AL_U_ID", "=", "'" + UID + "'", "AND");
        db.DB_Data_Get.DB_Filter.DB_WHERE_Allgemein("cms_auth_liste_gu", "AL_G_ID", "=", "'12'", "");

        Container con = db.DB_Data_Get.DB_SEND_AND_GET_Container();

        if (con.size() > 0) {
            return UID;
        } else {
            return 0;
        }

    }
    
    /*********************************************************/
    
    
    
    @AutoGenerated
	private HorizontalLayout buildMainLayout() {
		// common part: create layout
		mainLayout = new HorizontalLayout();
		mainLayout.setImmediate(false);
		mainLayout.setWidth("100%");
		mainLayout.setHeight("100%");
		mainLayout.setMargin(false);
		
		// top-level component properties
		setWidth("100.0%");
		setHeight("100.0%");
		
		// vl_main
		vl_main = buildVl_main();
		mainLayout.addComponent(vl_main);
		mainLayout.setExpandRatio(vl_main, 1.0f);
		mainLayout.setComponentAlignment(vl_main, new Alignment(20));
		
		return mainLayout;
	}

	@AutoGenerated
	private VerticalLayout buildVl_main() {
		// common part: create layout
		vl_main = new VerticalLayout();
		vl_main.setImmediate(false);
		vl_main.setWidth("100.0%");
		vl_main.setHeight("100.0%");
		vl_main.setMargin(true);
		
		// vl_menuSpacer
		vl_menuSpacer = buildVl_menuSpacer();
		vl_main.addComponent(vl_menuSpacer);
		
		// tbl_data
		tbl_data = new FilterTable();
		tbl_data.setImmediate(true);
		tbl_data.setWidth("100.0%");
		tbl_data.setHeight("100.0%");
		vl_main.addComponent(tbl_data);
		vl_main.setExpandRatio(tbl_data, 1.0f);
		vl_main.setComponentAlignment(tbl_data, new Alignment(20));
		
		return vl_main;
	}

	@AutoGenerated
	private VerticalLayout buildVl_menuSpacer() {
		// common part: create layout
		vl_menuSpacer = new VerticalLayout();
		vl_menuSpacer.setImmediate(false);
		vl_menuSpacer.setWidth("100.0%");
		vl_menuSpacer.setHeight("40px");
		vl_menuSpacer.setMargin(false);
		
		// men_frm
		men_frm = new MenuBar();
		men_frm.setImmediate(false);
		men_frm.setWidth("100.0%");
		men_frm.setHeight("-1px");
		vl_menuSpacer.addComponent(men_frm);
		vl_menuSpacer.setComponentAlignment(men_frm, new Alignment(20));
		
		return vl_menuSpacer;
	}
}
