package archenoah.web.normal.main.Menuepunkte.Individuelle.Stammdaten.Patientenverwaltung.classes;

import java.sql.Timestamp;
import java.text.DateFormat;
import java.util.Date;

import archenoah.lib.custom.MyUtils;
import archenoah.lib.vaadin.Components.Fields.DateFieldDisplay;
import archenoah.lib.vaadin.Components.Fields.IntegerFieldDisplay;

import com.vaadin.annotations.AutoGenerated;
import com.vaadin.data.Item;
import com.vaadin.data.util.converter.Converter;
import com.vaadin.shared.ui.label.ContentMode;
import com.vaadin.ui.Alignment;
import com.vaadin.ui.Button;
import com.vaadin.ui.CustomComponent;
import com.vaadin.ui.HorizontalLayout;
import com.vaadin.ui.Label;
import com.vaadin.ui.TextField;
import com.vaadin.ui.VerticalLayout;

public class PatientCommentWrapper extends CustomComponent {
    
    /*- VaadinEditorProperties={"grid":"RegularGrid,20","showGrid":true,"snapToGrid":true,"snapToObject":true,"movingGuides":false,"snappingDistance":10} */

    @AutoGenerated
    private VerticalLayout mainLayout;
    @AutoGenerated
    private Label comment;
    @AutoGenerated
    private HorizontalLayout horizontalLayout_1;
    @AutoGenerated
    private Button edit;
    @AutoGenerated
    private IntegerFieldDisplay data;
    @AutoGenerated
    private TextField type;
    @AutoGenerated
    private TextField author;
    @AutoGenerated
    private DateFieldDisplay updated;
    @AutoGenerated
    private DateFieldDisplay created;
    // {section fields}
    // ****************
    private Converter<String, Object> authorConverter;
    private Converter<String, Object> typeConverter;
    // {end fields}

    // {section constructors}
    // **********************
    public PatientCommentWrapper() {
        setCompositionRoot(buildMainLayout());
        configureComponents();
    }
    // {end constructors}

    // {section gettersandsetters}
    // ***************************
    public void setValue(Item item) {
        
        Timestamp cr = MyUtils.getValueFromItem(item, "PC_CREATED", java.sql.Timestamp.class);
        Timestamp up = MyUtils.getValueFromItem(item, "PC_UPDATED", java.sql.Timestamp.class);
        
        created.setValue(cr != null ? cr : new Date());
        updated.setValue(up != null ? up : new Date());
        
        comment.setValue(MyUtils.getValueFromItem(item, "PC_COMMENT", String.class));
        author.setValue(authorConverter.convertToPresentation(MyUtils.getValueFromItem(item, "PC_ID_AUTHOR", Integer.class), String.class, getLocale()));
        type.setValue(typeConverter.convertToPresentation(MyUtils.getValueFromItem(item, "PC_TYPE", String.class), String.class, getLocale()));
        data.setValue(MyUtils.getValueFromItem(item, "PC_DATA", Integer.class));
    }
    
    @Override
    public void setReadOnly(boolean readonly) {
        created.setReadOnly(readonly);
        updated.setReadOnly(readonly);
        comment.setReadOnly(readonly);
        author.setReadOnly(readonly);
        type.setReadOnly(readonly);
        data.setReadOnly(readonly);
    }
    
    public void setTypeConverter(Converter<String, Object> converter) {
        this.typeConverter = converter;
    }
    
    public void setAuthorConverter(Converter<String, Object> converter) {
        this.authorConverter = converter;
    }
    // {end gettersandsetters}

    // {section publicmethods}
    // ***********************
    // {end publicmethods}

    // {section privatemethods}
    // ************************
    private void configureComponents() {
        
        // hide these for now
        edit.setVisible(false);
        updated.setVisible(false);
        
//        comment.setNullRepresentation("");
        comment.setContentMode(ContentMode.TEXT);
        comment.setStyleName("pre-wrap");
        author.setNullRepresentation("");
        type.setNullRepresentation("");
        data.setNullRepresentation("");
        
        created.setTimeFormat(DateFormat.SHORT);
        updated.setTimeFormat(DateFormat.SHORT);
    }
    // {end privatemethods}

    // {section database}
    // ******************
    // {end database}

    // {section layout}
    // ****************
    
    @AutoGenerated
    private VerticalLayout buildMainLayout() {
        // common part: create layout
        mainLayout = new VerticalLayout();
        mainLayout.setImmediate(false);
        mainLayout.setWidth("100%");
        mainLayout.setHeight("100%");
        mainLayout.setMargin(false);
        mainLayout.setSpacing(true);
        
        // top-level component properties
        setWidth("100.0%");
        setHeight("100.0%");
        
        // horizontalLayout_1
        horizontalLayout_1 = buildHorizontalLayout_1();
        mainLayout.addComponent(horizontalLayout_1);
        
        // comment
        comment = new Label();
        comment.setImmediate(false);
        comment.setWidth("100.0%");
        comment.setHeight("-1px");
        mainLayout.addComponent(comment);
        mainLayout.setExpandRatio(comment, 1.0f);
        
        return mainLayout;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_1() {
        // common part: create layout
        horizontalLayout_1 = new HorizontalLayout();
        horizontalLayout_1.setImmediate(false);
        horizontalLayout_1.setWidth("100.0%");
        horizontalLayout_1.setHeight("-1px");
        horizontalLayout_1.setMargin(false);
        horizontalLayout_1.setSpacing(true);
        
        // created
        created = new DateFieldDisplay();
        created.setCaption("Erstellt");
        created.setImmediate(false);
        created.setWidth("-1px");
        created.setHeight("-1px");
        horizontalLayout_1.addComponent(created);
        horizontalLayout_1.setComponentAlignment(created, new Alignment(33));
        
        // updated
        updated = new DateFieldDisplay();
        updated.setCaption("Bearbeitet");
        updated.setImmediate(false);
        updated.setWidth("-1px");
        updated.setHeight("-1px");
        horizontalLayout_1.addComponent(updated);
        horizontalLayout_1.setComponentAlignment(updated, new Alignment(33));
        
        // author
        author = new TextField();
        author.setCaption("Ersteller");
        author.setImmediate(false);
        author.setWidth("-1px");
        author.setHeight("-1px");
        horizontalLayout_1.addComponent(author);
        horizontalLayout_1.setComponentAlignment(author, new Alignment(33));
        
        // type
        type = new TextField();
        type.setCaption("Typ");
        type.setImmediate(false);
        type.setWidth("-1px");
        type.setHeight("-1px");
        horizontalLayout_1.addComponent(type);
        horizontalLayout_1.setComponentAlignment(type, new Alignment(33));
        
        // data
        data = new IntegerFieldDisplay();
        data.setCaption("ID");
        data.setImmediate(false);
        data.setWidth("-1px");
        data.setHeight("-1px");
        horizontalLayout_1.addComponent(data);
        horizontalLayout_1.setComponentAlignment(data, new Alignment(33));
        
        // edit
        edit = new Button();
        edit.setCaption("Bearbeiten");
        edit.setImmediate(false);
        edit.setWidth("-1px");
        edit.setHeight("-1px");
        horizontalLayout_1.addComponent(edit);
        horizontalLayout_1.setExpandRatio(edit, 1.0f);
        horizontalLayout_1.setComponentAlignment(edit, new Alignment(10));
        
        return horizontalLayout_1;
    }
    
    
    
    // {end layout}
}
