package archenoah.web.normal.main.Menuepunkte.Individuelle.Projekte.Projektuebersicht.servicetasking.form.submodules;

import org.tepi.filtertable.FilterTreeTable;

import archenoah.lib.custom.comments.types.OrganisationComments;
import archenoah.lib.vaadin.Components.Steppers.IntStepper;
import archenoah.lib.vaadin.Language.i18n.I18nManager;
import archenoah.web.normal.main.Menuepunkte.Individuelle.Projekte.Projektuebersicht.servicetasking.modules.ModuleComponent;
import archenoah.web.normal.main.Menuepunkte.Individuelle.Projekte.Projektuebersicht.servicetasking.modules.ModuleEntry;
import archenoah.web.normal.main.Menuepunkte.Individuelle.Projekte.Projektuebersicht.servicetasking.modules.converters.DatetimeConverter;

import com.vaadin.annotations.AutoGenerated;
import com.vaadin.data.Property.ValueChangeEvent;
import com.vaadin.data.Property.ValueChangeListener;
import com.vaadin.ui.CheckBox;
import com.vaadin.ui.PopupDateField;
import com.vaadin.ui.TabSheet;
import com.vaadin.ui.TextField;
import com.vaadin.ui.VerticalLayout;

public class SubmoduleTest extends ModuleComponent {

    /*- VaadinEditorProperties={"grid":"RegularGrid,20","showGrid":true,"snapToGrid":true,"snapToObject":true,"movingGuides":false,"snappingDistance":10} */

    @AutoGenerated
    private VerticalLayout mainLayout;
    @AutoGenerated
    private TabSheet tabSheet_1;
    @AutoGenerated
    private VerticalLayout verticalLayout_2;
    @AutoGenerated
    private FilterTreeTable tree;
    @AutoGenerated
    private TextField multi2;
    @AutoGenerated
    private TextField multi1;
    @AutoGenerated
    private PopupDateField test3;
    @AutoGenerated
    private TextField test2;
    @AutoGenerated
    private TextField test;
    @AutoGenerated
    private IntStepper org;
    @AutoGenerated
    private VerticalLayout verticalLayout_3;
    @AutoGenerated
    private OrganisationComments comments;
    
    
    

    // {section fields}
    // ****************
    
    private I18nManager i18n;
    
    // {end fields}

    // {section constructors}
    // **********************
    public SubmoduleTest() {
        setCompositionRoot(buildMainLayout());
        
        i18n = new I18nManager(this);
        
        registerEntry(
            new ModuleEntry("cust_protokoll_servicetasking_module_test", "PARENT")
            .withField(test, "TEST")
            .withField(test2, "TEST2")
            .withField(test3, "TEST3", new DatetimeConverter())
            );
        
        registerEntry(
            new ModuleEntry("cust_protokoll_servicetasking_module_test_multi", "PARENT")
            .withMultiKey("KEY")
            .withMultiField(multi1, "DATA", 1)
            .withMultiField(multi2, "DATA", 2)
            );
        
        i18n.includeTableProperties(tree, "cb");
        
        dummyTable();
        configureComponents();
        
        i18n.refresh();
        
    }

    // {end constructors}

    // {section gettersandsetters}
    // ***************************
    // {end gettersandsetters}

    // {section publicmethods}
    // ***********************

    // {end publicmethods}

    // {section privatemethods}
    // ************************
    
    private void configureComponents() {
        
        comments.setOrigin(SubmoduleTest.class);
        
        addFieldChangeListener(new FieldValueChangeListener() {
            
            @Override
            public void onFieldValueChange(FieldValue fieldValue, Object value, Class<?> type) {
                
                switch (fieldValue) {
                case PARENT:
                    if(value != null) {
                        comments.setDataId((Integer) value);
                    }
                    break;
                    
                case READONLY:
                    comments.allowAdd((Boolean) value);
                    break;
                default:
                    break;
                }
                
            }
        });
        
        org.addValueChangeListener(new ValueChangeListener() {
            
            @Override
            public void valueChange(ValueChangeEvent event) {
                
                comments.setParentId(org.getValue());
                
            }
        });
        
        addSaveListener(new SaveListener() {
            
            @Override
            public void onSave() {
                
                comments.save();
                
            }
        });
    }
    
    @SuppressWarnings("unchecked")
    private void dummyTable() {
        
        tree.addContainerProperty("cb", CheckBox.class, new CheckBox());
        tree.addContainerProperty("text", String.class, "apple");
        tree.addItem(1).getItemProperty("cb").setValue(new CheckBox("banana"));
        
    }
    // {end privatemethods}

    // {section database}
    // ******************
    // {end database}

    @AutoGenerated
    private VerticalLayout buildMainLayout() {
        // common part: create layout
        mainLayout = new VerticalLayout();
        mainLayout.setImmediate(false);
        mainLayout.setWidth("100%");
        mainLayout.setHeight("100%");
        mainLayout.setMargin(false);
        
        // top-level component properties
        setWidth("100.0%");
        setHeight("100.0%");
        
        // tabSheet_1
        tabSheet_1 = buildTabSheet_1();
        mainLayout.addComponent(tabSheet_1);
        
        return mainLayout;
    }

    @AutoGenerated
    private TabSheet buildTabSheet_1() {
        // common part: create layout
        tabSheet_1 = new TabSheet();
        tabSheet_1.setImmediate(true);
        tabSheet_1.setWidth("100.0%");
        tabSheet_1.setHeight("100.0%");
        
        // verticalLayout_3
        verticalLayout_3 = buildVerticalLayout_3();
        tabSheet_1.addTab(verticalLayout_3, "Comments", null);
        
        // verticalLayout_2
        verticalLayout_2 = buildVerticalLayout_2();
        tabSheet_1.addTab(verticalLayout_2, "Data", null);
        
        return tabSheet_1;
    }

    @AutoGenerated
    private VerticalLayout buildVerticalLayout_3() {
        // common part: create layout
        verticalLayout_3 = new VerticalLayout();
        verticalLayout_3.setImmediate(false);
        verticalLayout_3.setWidth("100.0%");
        verticalLayout_3.setHeight("100.0%");
        verticalLayout_3.setMargin(true);
        
        // comments
        comments = new OrganisationComments();
        comments.setImmediate(false);
        comments.setWidth("100.0%");
        comments.setHeight("100.0%");
        verticalLayout_3.addComponent(comments);
        
        return verticalLayout_3;
    }

    @AutoGenerated
    private VerticalLayout buildVerticalLayout_2() {
        // common part: create layout
        verticalLayout_2 = new VerticalLayout();
        verticalLayout_2.setImmediate(false);
        verticalLayout_2.setWidth("100.0%");
        verticalLayout_2.setHeight("100.0%");
        verticalLayout_2.setMargin(false);
        
        // org
        org = new IntStepper();
        org.setCaption("org");
        org.setImmediate(false);
        org.setWidth("-1px");
        org.setHeight("-1px");
        verticalLayout_2.addComponent(org);
        
        // test
        test = new TextField();
        test.setCaption("test");
        test.setImmediate(false);
        test.setWidth("-1px");
        test.setHeight("-1px");
        test.setRequired(true);
        test.setMaxLength(50);
        verticalLayout_2.addComponent(test);
        
        // test2
        test2 = new TextField();
        test2.setCaption("test2");
        test2.setImmediate(false);
        test2.setWidth("-1px");
        test2.setHeight("-1px");
        test2.setRequired(true);
        test2.setMaxLength(50);
        verticalLayout_2.addComponent(test2);
        
        // test3
        test3 = new PopupDateField();
        test3.setCaption("test3");
        test3.setImmediate(false);
        test3.setWidth("-1px");
        test3.setHeight("-1px");
        test3.setRequired(true);
        verticalLayout_2.addComponent(test3);
        
        // multi1
        multi1 = new TextField();
        multi1.setCaption("multi1");
        multi1.setImmediate(false);
        multi1.setWidth("-1px");
        multi1.setHeight("-1px");
        verticalLayout_2.addComponent(multi1);
        
        // multi2
        multi2 = new TextField();
        multi2.setCaption("multi2");
        multi2.setImmediate(false);
        multi2.setWidth("-1px");
        multi2.setHeight("-1px");
        verticalLayout_2.addComponent(multi2);
        
        // tree
        tree = new FilterTreeTable();
        tree.setImmediate(false);
        tree.setWidth("100.0%");
        tree.setHeight("200px");
        verticalLayout_2.addComponent(tree);
        
        return verticalLayout_2;
    }
}
