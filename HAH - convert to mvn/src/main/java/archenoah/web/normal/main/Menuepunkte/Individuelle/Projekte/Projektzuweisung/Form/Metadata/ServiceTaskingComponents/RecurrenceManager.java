package archenoah.web.normal.main.Menuepunkte.Individuelle.Projekte.Projektzuweisung.Form.Metadata.ServiceTaskingComponents;

import archenoah.lib.vaadin.Components.MultiRowData.MultiRowDataComponent;
import archenoah.lib.vaadin.Components.MultiRowData.MultiRowImplementation;
import archenoah.lib.vaadin.Language.i18n.I18nConverter;

import com.vaadin.annotations.AutoGenerated;
import com.vaadin.data.Container;
import com.vaadin.data.Item;
import com.vaadin.data.Property.ValueChangeListener;
import com.vaadin.ui.CustomComponent;
import com.vaadin.ui.VerticalLayout;

public class RecurrenceManager extends CustomComponent implements MultiRowImplementation{

    private VerticalLayout mainLayout;
    
    // {section fields}
    // ****************
    MultiRowDataComponent multiRow;
    // {end fields}

    private I18nConverter typeConverter;

    // {section constructors}
    // **********************
    public RecurrenceManager() {
        setCompositionRoot(buildMainLayout());
        
        getTypes();
      
        RecurrenceManagerInput input = new RecurrenceManagerInput();
        input.setTypeConverter(typeConverter);
        
        multiRow = new MultiRowDataComponent(
                "cust_protokoll_servicetasking_meta_dynamic"
                , "STMD_ID"
                , "STMD_VH_ID"
                , input);
        multiRow.setVisibleColumns(new Object[] {"STMD_TYPE", "STMD_RRULE_START"});
        
        mainLayout.addComponent(multiRow);
        multiRow.setSizeFull();
        multiRow.setParentId(0);
        
    }
    // {end constructors}

    // {section gettersandsetters}
    // ***************************
    // {end gettersandsetters}

    // {section publicmethods}
    // ***********************
    
    @Override
    public void setParentId(Integer id) {
        multiRow.setParentId(id);
    }
    
    public void setParentIdOnly(Integer id) {
        multiRow.setParentIdOnly(id);
    }
    
    public Integer getParentId() {
        return multiRow.getParentId();
    }
    
    @Override
    public void save() {
        multiRow.save();
    }
    
    public void save(Integer id) {
        multiRow.save(id);
    }
    
    @Override
    public void saveAndUpdate() {
        multiRow.saveAndUpdate();
    }
    
    public Container getContainer() {
        return multiRow.getContainer();
    }
    
    @Override
    public void setEnabled(boolean enabled) {
        multiRow.setEnabled(enabled);
    }
    
    public Item getItem() {
        return multiRow.getSelectedItem();
    }
    
    public void addValueChangeListener(ValueChangeListener vcl) {
        multiRow.addValueChangeListener(vcl);
    }
    
    @Override
    public void setWidth(String width) {
        mainLayout.setWidth(width);
    }
    
    @Override
    public void setHeight(String height) {
        mainLayout.setHeight(height);
    }
    // {end publicmethods}

    // {section privatemethods}
    // ************************
    // {end privatemethods}

    // {section database}
    // ******************
    private void getTypes() {
        typeConverter = new I18nConverter("cust_protokoll_servicetasking_master_types", "STXT_ID", "STXT_KEY");
    }
    // {end database}

    // {section layout}
    // ****************
    @AutoGenerated
    private VerticalLayout buildMainLayout() {
        // common part: create layout
        mainLayout = new VerticalLayout();
        mainLayout.setStyleName("cust_margin_none");
        mainLayout.setImmediate(false);
        mainLayout.setWidth("100%");
        mainLayout.setHeight("100%");
        mainLayout.setMargin(false);
        mainLayout.setSpacing(true);
        
        // top-level component properties
        setWidth("100.0%");
        setHeight("100.0%");
        
        return mainLayout;
    }
    // {end layout}
}
