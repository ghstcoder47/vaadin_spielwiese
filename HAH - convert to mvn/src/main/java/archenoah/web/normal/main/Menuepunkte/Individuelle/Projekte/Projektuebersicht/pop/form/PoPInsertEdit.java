package archenoah.web.normal.main.Menuepunkte.Individuelle.Projekte.Projektuebersicht.pop.form;

import java.util.ArrayList;
import java.util.Date;
import java.util.HashMap;
import java.util.Map;
import java.util.Map.Entry;

import archenoah.global.UserAttributes;
import archenoah.lib.custom.ComponentIterator;
import archenoah.lib.custom.MyUtils;
import archenoah.lib.tool.comunication.dbclass.DBClass;
import archenoah.lib.tool.comunication.dbclass.DBClass.CustomQuery;
import archenoah.lib.vaadin.Components.Combo.combo;
import archenoah.lib.vaadin.Components.Fields.BooleanComboBox;
import archenoah.lib.vaadin.Components.Fields.CustomTimePicker;
import archenoah.lib.vaadin.Components.Steppers.FloatStepper;
import archenoah.lib.vaadin.Components.Steppers.IntStepper;
import archenoah.lib.vaadin.Components.Window_Tab_Generierer.Build_Tab_Menue_Item;
import archenoah.lib.vaadin.Components.Window_Tab_Generierer.Build_Window_Button;
import archenoah.lib.vaadin.Forms_Builder.Form_Bind;
import archenoah.lib.vaadin.Language.i18n.I18nCB;
import archenoah.lib.vaadin.Language.i18n.I18nConverter;
import archenoah.lib.vaadin.Language.i18n.I18nGlobalNotifiers;
import archenoah.lib.vaadin.Language.i18n.I18nManager;
import archenoah.lib.vaadin.Language.i18n.I18nNB;
import archenoah.lib.vaadin.MenuBerechtigung.Rechteholen;
import archenoah.lib.vaadin.resources.Icons;
import archenoah.lib.vaadin.validator.ValidatorManager;
import archenoah.lib.vaadin.validator.ValidatorManager.OptionalSaveAction;
import archenoah.lib.vaadin.validator.ValidatorType;
import archenoah.web.normal.UserInfo.UserData;
import archenoah.web.normal.main.Menuepunkte.Individuelle.Projekte.Prescriptions.PrescriptionManager.classes.StockPatientBalance;
import archenoah.web.normal.main.Menuepunkte.Individuelle.Projekte.Projektuebersicht.classes.InfusionProductSource;
import archenoah.web.normal.main.Menuepunkte.Individuelle.Projekte.Projektuebersicht.classes.ProjectLimits;
import archenoah.web.normal.main.Menuepunkte.Individuelle.Projekte.Projektuebersicht.classes.ProjectNurseCombos;
import archenoah.web.normal.main.Menuepunkte.Individuelle.Projekte.Projektuebersicht.classes.RegionalLeadCheck;
import archenoah.web.normal.main.Menuepunkte.Individuelle.Projekte.Projektuebersicht.classes.RegionalLeadCheck.FieldType;
import archenoah.web.normal.main.Menuepunkte.Individuelle.Projekte.Projektuebersicht.pop.classes.I18nPoPProcessConverter;
import archenoah.web.normal.main.Menuepunkte.Individuelle.Projekte.Projektuebersicht.pop.classes.PanelCharges;
import archenoah.web.normal.main.Menuepunkte.Individuelle.Projekte.Projektuebersicht.pop.classes.PanelInfusionTimes;
import archenoah.web.normal.main.Menuepunkte.Individuelle.Projekte.Projektuebersicht.pop.classes.PanelPostMed;
import archenoah.web.normal.main.Menuepunkte.Individuelle.Projekte.Projektuebersicht.pop.classes.PanelPreMed;
import archenoah.web.normal.main.Menuepunkte.Individuelle.Projekte.Projektuebersicht.pop.classes.PanelVitals;
import archenoah.web.normal.main.Menuepunkte.Individuelle.Projekte.Projektzuweisung.Form.ProjektzuweisungDataView;
import archenoah.web.normal.main.Menuepunkte.Individuelle.Projekte.tools.form_Berrechnen_Strecke;
import archenoah.web.normal.main.Menuepunkte.Individuelle.Stammdaten.Krankenschwesternverwaltung.forms.form_nurse_insert_edit;
import archenoah.web.normal.main.Menuepunkte.Individuelle.Stammdaten.Patientenverwaltung.Form.form_patient_insert_edit;

import com.google.common.base.Joiner;
import com.vaadin.annotations.AutoGenerated;
import com.vaadin.data.Container;
import com.vaadin.data.Item;
import com.vaadin.data.Property;
import com.vaadin.data.Property.ValueChangeEvent;
import com.vaadin.data.Property.ValueChangeListener;
import com.vaadin.data.Validator;
import com.vaadin.data.validator.IntegerRangeValidator;
import com.vaadin.event.FieldEvents.FocusEvent;
import com.vaadin.event.FieldEvents.FocusListener;
import com.vaadin.server.ThemeResource;
import com.vaadin.shared.ui.combobox.FilteringMode;
import com.vaadin.shared.ui.datefield.Resolution;
import com.vaadin.shared.ui.label.ContentMode;
import com.vaadin.ui.AbsoluteLayout;
import com.vaadin.ui.AbstractComponent;
import com.vaadin.ui.AbstractField;
import com.vaadin.ui.Alignment;
import com.vaadin.ui.Button;
import com.vaadin.ui.Button.ClickEvent;
import com.vaadin.ui.Button.ClickListener;
import com.vaadin.ui.CheckBox;
import com.vaadin.ui.ComboBox;
import com.vaadin.ui.CustomComponent;
import com.vaadin.ui.GridLayout;
import com.vaadin.ui.HorizontalLayout;
import com.vaadin.ui.Label;
import com.vaadin.ui.MenuBar.MenuItem;
import com.vaadin.ui.NativeSelect;
import com.vaadin.ui.Panel;
import com.vaadin.ui.PopupDateField;
import com.vaadin.ui.TabSheet;
import com.vaadin.ui.TextArea;
import com.vaadin.ui.TextField;
import com.vaadin.ui.UI;
import com.vaadin.ui.VerticalLayout;
import com.vaadin.ui.Window;
import com.vaadin.ui.Window.CloseEvent;
import com.vaadin.ui.Window.CloseListener;

@SuppressWarnings({"serial", "rawtypes", "unchecked"})
public class PoPInsertEdit extends CustomComponent {

    /*- VaadinEditorProperties={"grid":"RegularGrid,20","showGrid":true,"snapToGrid":true,"snapToObject":true,"movingGuides":false,"snappingDistance":10} */

    @AutoGenerated
    private VerticalLayout mainLayout;

    @AutoGenerated
    private AbsoluteLayout al_passive_fields;

    @AutoGenerated
    private IntStepper fieldBalanceWasRemoved;

    @AutoGenerated
    private AbsoluteLayout al_localization_labels;

    @AutoGenerated
    private Label lbl_yes;

    @AutoGenerated
    private Label lbl_no;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_4;

    @AutoGenerated
    private Button btn_save;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_3;

    @AutoGenerated
    private TabSheet pan_BesD;

    @AutoGenerated
    private VerticalLayout vl_comments;

    @AutoGenerated
    private TextArea txta_bemerkungen;

    @AutoGenerated
    private TextArea txta_beobachtungen;

    @AutoGenerated
    private VerticalLayout vl_events;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_22;

    @AutoGenerated
    private ComboBox correlation;

    @AutoGenerated
    private BooleanComboBox causedBy;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_21;

    @AutoGenerated
    private TextArea ta_reaction_recent_desc;

    @AutoGenerated
    private VerticalLayout verticalLayout_17;

    @AutoGenerated
    private ComboBox cbx_reaction_recent_intensity;

    @AutoGenerated
    private NativeSelect ns_reaction_recent;

    @AutoGenerated
    private Label lbl_reaction_recent;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_18;

    @AutoGenerated
    private TextArea ta_reaction_today_desc;

    @AutoGenerated
    private VerticalLayout verticalLayout_15;

    @AutoGenerated
    private ComboBox cbx_reaction_today_intensity;

    @AutoGenerated
    private NativeSelect ns_reaction_today;

    @AutoGenerated
    private Label lbl_reaction_today;

    @AutoGenerated
    private VerticalLayout vl_inf;

    @AutoGenerated
    private TabSheet tab_inf;

    @AutoGenerated
    private VerticalLayout layoutPostmed;

    @AutoGenerated
    private PanelPostMed panelPostMed;

    @AutoGenerated
    private VerticalLayout layoutVitals;

    @AutoGenerated
    private PanelVitals panelVitals;

    @AutoGenerated
    private VerticalLayout layoutTimes;

    @AutoGenerated
    private PanelInfusionTimes panelInfusionTimes;

    @AutoGenerated
    private VerticalLayout layoutCharges;

    @AutoGenerated
    private PanelCharges panelCharges;

    @AutoGenerated
    private VerticalLayout layoutInfusion;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_6;

    @AutoGenerated
    private VerticalLayout layoutMainMed;

    @AutoGenerated
    private HorizontalLayout layoutMainMedInfo;

    @AutoGenerated
    private VerticalLayout layoutMainMedInfoRight;

    @AutoGenerated
    private FloatStepper mainMedTotalVolume;

    @AutoGenerated
    private HorizontalLayout layoutCount;

    @AutoGenerated
    private InfusionProductSource productSource;

    @AutoGenerated
    private IntStepper mainMedCount;

    @AutoGenerated
    private TextField punctComment;

    @AutoGenerated
    private HorizontalLayout layout_port;

    @AutoGenerated
    private TextField punctPortDetails;

    @AutoGenerated
    private TextField punctPortBlock;

    @AutoGenerated
    private VerticalLayout layoutMainMedInfoleft;

    @AutoGenerated
    private FloatStepper mainMedFlush;

    @AutoGenerated
    private FloatStepper mainMedVolume;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_20;

    @AutoGenerated
    private FloatStepper mainMedSolventVolume;

    @AutoGenerated
    private ComboBox mainMedSolvent;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_19;

    @AutoGenerated
    private Label mainMedDosageUnitLabel;

    @AutoGenerated
    private FloatStepper mainMedDosage;

    @AutoGenerated
    private TextField mainMedName;

    @AutoGenerated
    private HorizontalLayout layoutPunct;

    @AutoGenerated
    private VerticalLayout layoutPunctRight;

    @AutoGenerated
    private VerticalLayout layoutPunctPortACath;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_15;

    @AutoGenerated
    private CheckBox portACathReady;

    @AutoGenerated
    private CheckBox portACathNew;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_12;

    @AutoGenerated
    private CheckBox portACathRight;

    @AutoGenerated
    private CheckBox portACathLeft;

    @AutoGenerated
    private CheckBox portACath;

    @AutoGenerated
    private HorizontalLayout layoutPunctArm;

    @AutoGenerated
    private CheckBox armRight;

    @AutoGenerated
    private CheckBox armLeft;

    @AutoGenerated
    private Label labelArm;

    @AutoGenerated
    private HorizontalLayout layoutPunctHand;

    @AutoGenerated
    private CheckBox handRight;

    @AutoGenerated
    private CheckBox handLeft;

    @AutoGenerated
    private Label labelHand;

    @AutoGenerated
    private HorizontalLayout layoutPunctElbow;

    @AutoGenerated
    private CheckBox elbowRight;

    @AutoGenerated
    private CheckBox elbowLeft;

    @AutoGenerated
    private Label labelElbow;

    @AutoGenerated
    private Label labelPunctPosition;

    @AutoGenerated
    private VerticalLayout layoutPunctLeft;

    @AutoGenerated
    private CheckBox pumpFilter;

    @AutoGenerated
    private ComboBox pumpTube;

    @AutoGenerated
    private ComboBox pumpType;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_16;

    @AutoGenerated
    private ComboBox punctNeedle;

    @AutoGenerated
    private IntStepper punctTries;

    @AutoGenerated
    private VerticalLayout layoutPremed;

    @AutoGenerated
    private PanelPreMed panelPreMed;

    @AutoGenerated
    private VerticalLayout vl_preinfo;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_13;

    @AutoGenerated
    private VerticalLayout verticalLayout_7;

    @AutoGenerated
    private Label lbl_weight;

    @AutoGenerated
    private FloatStepper weigthPatient;

    @AutoGenerated
    private ComboBox cbx_type;

    @AutoGenerated
    private Panel pan_abrechnungsdaten;

    @AutoGenerated
    private VerticalLayout verticalLayout_5;

    @AutoGenerated
    private GridLayout gridLayout_2;

    @AutoGenerated
    private VerticalLayout verticalLayout_8;

    @AutoGenerated
    private CheckBox cb_parallel;

    @AutoGenerated
    private CheckBox cb_admin;

    @AutoGenerated
    private VerticalLayout vl_cs;

    @AutoGenerated
    private IntStepper billingKilometersCS;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_5;

    @AutoGenerated
    private IntStepper billingMinutesCS;

    @AutoGenerated
    private IntStepper billingHoursCS;

    @AutoGenerated
    private Button btn_km_ber;

    @AutoGenerated
    private VerticalLayout vl_nurse;

    @AutoGenerated
    private IntStepper billingKilometersNurse;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_10;

    @AutoGenerated
    private IntStepper billingMinutesNurse;

    @AutoGenerated
    private IntStepper billingHoursNurse;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_2;

    @AutoGenerated
    private Panel pan_stammdaten;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_1;

    @AutoGenerated
    private VerticalLayout verticalLayout_16;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_17;

    @AutoGenerated
    private RegionalLeadCheck cb_regionalmanager_ok;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_14;

    @AutoGenerated
    private ComboBox cbx_arzt;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_7;

    @AutoGenerated
    private ComboBox cb_status;

    @AutoGenerated
    private VerticalLayout verticalLayout_3;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_9;

    @AutoGenerated
    private ComboBox cb_nurse;

    @AutoGenerated
    private VerticalLayout verticalLayout_9;

    @AutoGenerated
    private Button btn_zuweisung;

    @AutoGenerated
    private VerticalLayout verticalLayout_6;

    @AutoGenerated
    private Button btn_nurse_info;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_8;

    @AutoGenerated
    private ComboBox cb_pat;

    @AutoGenerated
    private TextField txt_initials;

    @AutoGenerated
    private VerticalLayout verticalLayout_4;

    @AutoGenerated
    private Button btn_pat_info;

    @AutoGenerated
    private Panel pan_dat;

    @AutoGenerated
    private VerticalLayout verticalLayout_2;

    @AutoGenerated
    private HorizontalLayout horizontalLayout_11;

    @AutoGenerated
    private CustomTimePicker txt_bis;

    @AutoGenerated
    private CustomTimePicker txt_von;

    @AutoGenerated
    private PopupDateField pop_date;

    @AutoGenerated
    private PopupDateField plannedDate;

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

	

    /**
     * The constructor should first build the main layout, set the composition
     * root and then do any custom initialization.
     * 
     * The constructor will not be automatically regenerated by the visual
     * editor.
     */

    /**************** --> Allgemein <--- ********************/
  
    // Datenbank
    private Map<Object, String> componentMap;
    private Map<Object, String> DBMap;
    private Form_Bind fb;
    private String dataSetId = "";

    private Item dataSetItem;
    
    private I18nManager i18n;
    private ValidatorManager val;
    
    // Berrechtigung
    private int ACC_ID;
	private Integer permRead;
	private Integer permUpdate;
	private Integer permCreate;
	private Integer permDelete;

    private MenuItem tmpMenu = null;
    private Button tmpButton = null;
    /******************************************************/
    /**************** --> Tabsheetvars <--- *****************/
    private TabSheet tab = null;
    /******************************************************/
    /**************** --> Windowvars <--- *******************/
    private Window win = null;
    /******************************************************/
    /******************* --> Custom <--- ********************/
    /******************************************************/
    
    org.slf4j.Logger log = org.slf4j.LoggerFactory.getLogger(this.getClass());
    
    private Validator balanceValidator;
    private Integer productId = 0;
    
    
    private ArrayList<Integer> projectIds = null;
    
    private boolean regionalManager = false;
    private boolean nurse = false;
    
    private Item metaDataItem;
    private Item productDataItem;
    
    private Boolean wasSaved = false;
    private Boolean confirmOptional = false;
    
    private ProjectLimits limit;
    
    /************ ----->Einstellungen<-- ********************/
    private final String formIdPerm = "410";
    private final String Windows_Height = "740px";
    private final String Windows_Width = "1000px";
    
    private final String dataIdCol = "ID";
    private final String dataTableName = "cust_protokoll_pop_daten";

    
    private final static class caption extends I18nCB{
        static final I18nCB missing_date = set();
        static final I18nCB lbl_yes = set();
        static final I18nCB lbl_no = set();
        
        static final I18nCB deviatingMainCount = set();
    }

    private final static class notifier extends I18nNB{
        static final I18nNB warning_external = set(HUMANIZED, MC, 5);
    }
    
    /******************************************************/

    public PoPInsertEdit(MenuItem Arg_Menü, String Arg_Form_ID) {
        tmpMenu = Arg_Menü;
        dataSetId = Arg_Form_ID;
    }

    public PoPInsertEdit(Button Arg_btn, String Arg_Form_ID) {
        tmpButton = Arg_btn;
        dataSetId = Arg_Form_ID;
    }
    
    /********* INIT-Window ************/
    public void init() {
        if (Windows_Height.equals("") == true || Windows_Width.equals("") == true) {
            System.out.println("Form Einstellung Fehlt: !!!");
            return;
        }

        Standard_Init();

        String fid = dataSetId;
        if (fid != "") {
            fid = " - #" + fid;
        }

        if (tmpMenu != null) {
        	
            String Recourcename = null;
            ThemeResource resource = null;
            if(tmpMenu.getIcon() != null){
            	Recourcename = tmpMenu.getIcon().toString();
            	Recourcename = Recourcename.substring(0, Recourcename.length() - 12) + "white-16.png";
            	resource = new ThemeResource(Recourcename);
            }

            Build_Window_Button bwb = new Build_Window_Button(tmpMenu.getText() + fid, mainLayout, Windows_Height, Windows_Width, resource);
            win = bwb.ReturnWindow();
        }
        if (tmpButton != null) {
            Build_Window_Button bwb = new Build_Window_Button(tmpButton.getCaption() + fid, mainLayout, Windows_Height, Windows_Width, tmpButton.getIcon());
            win = bwb.ReturnWindow();
        }

    }

    /********* INIT-Tray ************/
    public void init(TabSheet Arg_tab) {

        Standard_Init();
        tab = Arg_tab;
        if (tmpMenu != null) {
            new Build_Tab_Menue_Item(Arg_tab, tmpMenu.getText(), mainLayout, tmpMenu.getIcon());
        }
        if (tmpButton != null) {
            new Build_Tab_Menue_Item(Arg_tab, tmpButton.getCaption(), mainLayout, tmpButton.getIcon());
        }

    }
    
    public Window getWindow(){
    	return win;
    }
    
    public TabSheet getTabSheet(){
    	return tab;
    }
    
    public Boolean wasSaved() {
        return wasSaved;
    }

    public void setSaved(Boolean wasSaved) {
        this.wasSaved = wasSaved;
    }
    
    /********* Init-Standard ************/
    private void Standard_Init() {
        buildMainLayout();
        i18n = new I18nManager(this);
        val = new ValidatorManager(this);
        
        fb = new Form_Bind();
        ACC_ID = (int) UI.getCurrent().getSession().getSession().getAttribute("Userid");
        
        getProjectIds();
        
        registerComponents();
        
        fillFields();
        fillDbMap();

        checkIsUserNurse();
        
        
        if (nurse == true && regionalManager == false) {
//            Fill_ns_P_Status_Nurse();
            cb_nurse.setValue(getNurseId());
            billingKilometersCS.setReadOnly(true);
            billingHoursCS.setReadOnly(true);
            billingMinutesCS.setReadOnly(true);

            vl_cs.setVisible(false);

            btn_zuweisung.setVisible(false);
            

        } else {

//            Fill_ns_P_Status();

        }
        cb_nurse.setNullSelectionAllowed(false);
        cb_pat.setReadOnly(true);
        cb_status.setNullSelectionAllowed(false);
        cb_regionalmanager_ok.setEnabled(regionalManager);
        
        /***************/

        if (dataSetId != "") {
        	
            dbFillForm();
            fillPanels(Integer.parseInt(dataSetId));
            
            if (nurse == true) {
                if ((int) cb_status.getValue() >= 3 && !regionalManager) {
                    setPermissions(0, 1, 0, 0);
                }
            }
            
        } else {
            
            cb_admin.setValue(true);
            productSource.setValue(InfusionProductSource.internal);
        	
        }
        
        fillNurses();
        fillPunctNeedles(true); //legacy handling
        
        getMetaData();
        setValidators();
        
        displayMedName();
        
        setMenuPermissions();
        configureComponents();
        
        setEventListeners();
        
        pan_BesD.setSelectedTab(vl_inf);
        tab_inf.setSelectedTab(layoutInfusion);
        
        isCommentRequired();
        fillLimit();
        
        i18n.ignore(mainMedDosageUnitLabel);
        
        i18n.refresh();
    }
    
    private void fillPanels(Integer dataId) {
        panelPreMed.getEntries(dataId);
        panelPostMed.getEntries(dataId);
        panelInfusionTimes.getEntries(dataId);
        panelVitals.getEntries(dataId);
        panelCharges.getEntries(dataId);
        
        // needs to be called after values are set as to not null saved value
        productSource.setType(cbx_type, 2);
    }
    
    private void setValidators() {
        
        Integer count = MyUtils.getValueFromItem(productDataItem, "PMP_COUNT", Integer.class); 
        
        if(count != null) {
            IntegerRangeValidator del = new IntegerRangeValidator(i18n.get(caption.deviatingMainCount), count, count);
            mainMedCount.addValidator(del);
            val.addOptionalValidation(mainMedCount, del);
        }
        
        mainMedCount.addValidator(new Validator() {
            
            @Override
            public void validate(Object value) throws InvalidValueException {
                
                if(cb_status.getValue() != null && (int) cb_status.getValue() > 2 && productSource.affectsBalance()){
                    
                    if(value == null || value.equals("")){
                        throw new InvalidValueException(productSource.getItemCaption(productSource.getValue()));
                    }
                    
                }
                
            }
        });

        
    }
    
    private void fillLimit() {
        limit = new ProjectLimits("POP", dataSetId, MyUtils.getValueFromItem(dataSetItem, "ID_DELEGATION", Integer.class));
        limit.setNurseSelect(cb_nurse);
        limit.setStatusSelect(cb_status);
        limit.setOriginalDate(MyUtils.getValueFromItem(dataSetItem, "ORIGINAL_DATE", Date.class));
        limit.limitDatePicker(pop_date);
    }
    
    private void fillCorrelation() {
        I18nConverter lc = new I18nConverter("cust_protokoll_correlations", "PCO_ID", "PCO_CORRELATION");
        lc.attachDatasource(correlation);
    }
    
    // register components for lng and validation tools
    private void registerComponents(){
    	componentMap = new HashMap<Object, String>();
    	new ComponentIterator(mainLayout).createMap(componentMap);
    }
    
    
    private void configureComponents(){
    	
    	for (Entry<Object, String> entry : componentMap.entrySet()) {
    		AbstractComponent field = (AbstractComponent) entry.getKey();
    		
			field.setImmediate(true);
			
			
			if(field instanceof ComboBox){
				((ComboBox)field).setFilteringMode(FilteringMode.CONTAINS);
			}
			
		}
    	
    	setBillingStepperLimits(billingHoursNurse, billingMinutesNurse, billingKilometersNurse);
    	setBillingStepperLimits(billingHoursCS, billingMinutesCS, billingKilometersCS);
    	weigthPatient.setMinValue(0F);
    	weigthPatient.setNumberOfDecimals(2);
    	weigthPatient.setNullValueAllowed(true);
    	
    	plannedDate.setReadOnly(true);
    	UserAttributes ua = new UserAttributes(UserData.get().getUserId());
        if(ua.getUserAttributeMap() != null && ua.getUserAttributeMap().containsKey("pop_change_planned_date")) {
            plannedDate.setReadOnly(false);
            
            plannedDate.addValueChangeListener(new ValueChangeListener() {
                @Override
                public void valueChange(ValueChangeEvent event) {
                    
                    limit.setOriginalDate(plannedDate.getValue());
                    limit.limitDatePicker(pop_date);
                    
                    pop_date.setValue(plannedDate.getValue());
                }
            });
            
        }
    	
    	
    	
    	pop_date.setResolution(Resolution.DAY);
    	pop_date.setImmediate(true);
    	pop_date.addValidator(new Validator() {
            
            @Override
            public void validate(Object value) throws InvalidValueException {
                
                if(value == null) {
                    throw new InvalidValueException(i18n.get(caption.missing_date));
                }
                
            }
        });
    	
    	btn_pat_info.setIcon(Icons.White.info_16);
    	btn_pat_info.setStyleName("button-image-only");
    	
    	btn_nurse_info.setIcon(Icons.White.info_16);
        btn_nurse_info.setStyleName("button-image-only");
    	
        btn_km_ber.setIcon(Icons.White.berechnen_16);
        btn_km_ber.setStyleName("button-image-only");
        
        cb_pat.setImmediate(true);
        cbx_arzt.setFilteringMode(FilteringMode.CONTAINS);

        btn_zuweisung.setEnabled(cb_pat.getValue() != null ? true : false);

        cb_nurse.setFilteringMode(FilteringMode.CONTAINS);
        cbx_type.setFilteringMode(FilteringMode.CONTAINS);

        punctNeedle.setImmediate(true);
        
        mainMedCount.setMinValue(0);
        
    	componentListeners();
    	
    	mainMedDosage.setMinValue(0F);
    	mainMedDosage.setNumberOfDecimals(2);
    	
//    	mainMedDosageUnit.setNullSelectionAllowed(false);
        mainMedDosageUnitLabel.setContentMode(ContentMode.HTML);
    	
    	mainMedVolume.setMinValue(0F);
    	mainMedVolume.setNumberOfDecimals(2);
    	
    	mainMedTotalVolume.setMinValue(0F);
    	mainMedTotalVolume.setNumberOfDecimals(2);
    	
    	mainMedSolventVolume.setMinValue(0F);
    	mainMedSolventVolume.setNumberOfDecimals(2);
    	
    	mainMedFlush.setMinValue(0F);
        mainMedFlush.setNumberOfDecimals(2);
    	
        mainMedName.setEnabled(false);
    	mainMedName.setStyleName("nogrey");
    	
    	txt_initials.setStyleName("nogrey");
    	txt_initials.setEnabled(false);
    	
        txt_von.setImmediate(true);
        txt_von.setUpperBound(txt_bis);
        
        txt_bis.setImmediate(true);
        txt_bis.setLowerBound(txt_von);
    	
    	// hide admin
        cb_admin.setVisible(false);
    }
    
    private void componentListeners(){
        
        
    	
    }
    
    
    private void setBillingStepperLimits(IntStepper h, IntStepper m, IntStepper km) {
        
        h.setNullValueAllowed(true);
        h.setMinValue(0);
        h.setMaxValue(24);
        h.setWidth("60px");
        
        m.setNullValueAllowed(true);
        m.setMinValue(0);
        m.setMaxValue(59);
        m.setWidth("60px");
        
        km.setNullValueAllowed(true);
        km.setMinValue(0);
//        km.setNumberOfDecimals(1);
        km.setWidth("80px");
        
    }
    
    /*************************** Events *******************************/

    private void setEventListeners() {

        final OptionalSaveAction optionalSaveAction = new OptionalSaveAction() {
            
            @Override
            public void onSave() {
                confirmOptional = true;
                btn_save.click();
                confirmOptional = false;
            }

        };
        
        btn_save.addClickListener(new ClickListener() {

            @Override
            public void buttonClick(ClickEvent event) {

                
                boolean validate = (cb_status.getValue() != null && (int) cb_status.getValue() > 2);
                
                if (validate && !val.isValid()) {
                    return;
                }
                
                if(validate && !confirmOptional && !val.isValidOptional(optionalSaveAction)) {
                    return;
                }
                
                
                if (dataSetId.equals("") == true) {
                	
                    dataSetId = Integer.toString(dbInsert());
                    
                } else {
                	
                    dbUpdate();

                }
                
                savePanels(Integer.parseInt(dataSetId));
                removeBalance();

                //TASK check if save successful
                UI.getCurrent().getUI().removeWindow(win);
                setSaved(true);
            }

        });
        
        cbx_type.addValueChangeListener(new ValueChangeListener() {
            
            @Override
            public void valueChange(ValueChangeEvent event) {
                
                if(isCommentRequired()) {
                    
                    i18n.notifier(notifier.warning_external);

                }
            }
        });
        
        cb_pat.addValueChangeListener(new Property.ValueChangeListener() {

            @Override
            public void valueChange(ValueChangeEvent event) {
                btn_zuweisung.setEnabled(cb_pat.getValue() != null ? true : false);
                fillNurses();
                selectDoc();

            }
        });

        btn_pat_info.addClickListener(new ClickListener() {

            @Override
            public void buttonClick(ClickEvent event) {
                // TODO Automatisch generierter Methodenstub
                if (cb_pat.getValue() == null) {
                    I18nManager.global(I18nGlobalNotifiers.no_entry_selected);

                    return;
                }

                form_patient_insert_edit pie = new form_patient_insert_edit(event.getButton(), "" + cb_pat.getValue());
                pie.Init_Class_Window();
                if (nurse == true) {
                    pie.Set_Berrechtigung_Custom(1, 1, 1, 1);
                } else {
                    pie.Set_Berrechtigung_Custom(1, 1, 1, 1);
                }

            }
        });

        btn_nurse_info.addClickListener(new ClickListener() {

            @Override
            public void buttonClick(ClickEvent event) {
                // TODO Automatisch generierter Methodenstub
                if (cb_nurse.getValue() == null) {
                    I18nManager.global(I18nGlobalNotifiers.no_entry_selected);

                    return;
                }

                form_nurse_insert_edit pie = new form_nurse_insert_edit(event.getButton(), "" + cb_nurse.getValue());
                pie.Init_Class_Window();
                pie.Set_Berrechtigung_Custom(1, 0, 0, 0);
            }
        });

        btn_zuweisung.addClickListener(new ClickListener() {

            @Override
            public void buttonClick(ClickEvent event) {
                ProjektzuweisungDataView pz = new ProjektzuweisungDataView(event.getButton());
                pz.setFilteredInit("2", Integer.toString((int) cb_pat.getValue()));
                
                pz.setPermissionsFromDatabase();
                pz.init();
                Window popupDV = pz.getWindow();
                
                popupDV.addCloseListener(new CloseListener() {

                    @Override
                    public void windowClose(CloseEvent e) {
                        fillNurses();
                    }
                });
            }
        });

        cbx_arzt.addFocusListener(new FocusListener() {

            @Override
            public void focus(FocusEvent event) {

                fillDocs();

            }
        });
        
        cb_nurse.setImmediate(true);
        cb_nurse.addValueChangeListener(new ValueChangeListener() {
            
            @Override
            public void valueChange(ValueChangeEvent event) {
                
                if(cb_status.getValue().equals(2)) {
                    cb_status.setValue(1);
                }
                
            }
        });
       
        btn_km_ber.addClickListener(new ClickListener() {

            @Override
            public void buttonClick(ClickEvent event) {

                form_Berrechnen_Strecke fbs = new form_Berrechnen_Strecke(event.getButton());

                if (nurse == true) {
                    fbs.fieldDistance = billingKilometersNurse;
                    fbs.fieldMin = billingMinutesNurse;
                    fbs.fieldHours = billingHoursNurse;
                } else {
                    fbs.fieldDistance = billingKilometersCS;
                    fbs.fieldMin = billingMinutesCS;
                    fbs.fieldHours = billingHoursCS;
                }

                if (cb_nurse.getValue() != null) {
                    fbs.Init_Class_Window((Integer) cb_nurse.getValue());
                } else {
                    fbs.Init_Class_Window();
                }

                if (cb_pat.getValue() != null) {
                    fbs.Set_nach((int) cb_pat.getValue());
                }

            }
        });
        
//        cb_status.addValueChangeListener(new Property.ValueChangeListener() {
//            @Override
//            public void valueChange(ValueChangeEvent event) {
//                boolean required = false;
////                boolean saveable = false;
//                if (cb_status.getValue() != null && (int) cb_status.getValue() > 2) {
//                    required = true;
//                }
//
////                if (ns_status.getValue() != null && (int) ns_status.getValue() != 1) {
////                    saveable = true;
////                }
//
//                billingHoursNurse.setRequired(required);
//                billingMinutesNurse.setRequired(required);
//                billingKilometersNurse.setRequired(required);
//
//                pop_date.setRequired(required);
//                txt_von.setRequired(required);
//                txt_bis.setRequired(required);
//                
//                cbx_type.setRequired(required);
//
//                
//            }
//        });
        
    }
    
    
    
    private Boolean isCommentRequired() {
        
        Boolean required = false;
        
        if(cbx_type.getValue() != null) {
            required = (Boolean) cbx_type.getContainerProperty(cbx_type.getValue(), "COMMENT_REQUIRED").getValue();
        }
        
        txta_beobachtungen.setRequired(required);
        
        return required;
    }
    
    private void savePanels(Integer dataId) {
        panelPreMed.save(dataId);
        panelPostMed.save(dataId);
        panelInfusionTimes.save(dataId);
        panelVitals.save(dataId);
        panelCharges.save(dataId);
    }
    
    /******************************************************************/
    
    private void displayMedName() {
        
        if(metaDataItem == null) {
            mainMedName.setValue("?");
            return;
        }
        
        if(metaDataItem.getItemProperty("PP_PRODUCT") != null) {
            mainMedName.setValue((String) metaDataItem.getItemProperty("PP_PRODUCT").getValue());
            mainMedDosageUnitLabel.setValue("<br />" + (String) metaDataItem.getItemProperty("PP_UNIT").getValue());
        }else {
            mainMedName.setValue("?");
            mainMedDosageUnitLabel.setValue("<br />?");
        }
        
    }
    
    /************************ --> Berrechtigung <-- **************************/

    @SuppressWarnings("unused")
    public void setPermissionsFromDatabase() {
        if (formIdPerm == "") {
            System.out.println("Form Einstellung Fehlt: Berechtigung");
            return;
        }

        ACC_ID = (int) UI.getCurrent().getSession().getSession().getAttribute("Userid");
        Rechteholen r = new Rechteholen(ACC_ID + "");
        String[][] perms = r.Datenholen();

        for (int i = 0; i < perms.length; i++) {
            if (perms[i][0].equals(formIdPerm) == true) {

                permRead = Integer.valueOf(perms[i][3]);
                permUpdate = Integer.valueOf(perms[i][4]);
                permCreate = Integer.valueOf(perms[i][6]);
                permDelete = Integer.valueOf(perms[i][5]);
                
            }
        }
    }

    public void setPermissions(int create, int read, int update, int delete) {

        permCreate = create;
        permRead = read;
        permUpdate = update;
        permDelete = delete;

    }

    private void setMenuPermissions() {
        Boolean c = (permCreate == 1);
        Boolean r = (permRead == 1);
        Boolean u = (permUpdate == 1);
        Boolean d = (permDelete == 1);

        btn_save.setEnabled((c||u));

    }
    
    public void setRegionalManagerEnabled(Boolean enabled){
        regionalManager = enabled;
    }
    
    /***********************************************/
    
    private void fillFields(){
    	fillInfusionTypes();
    	fillPunctNeedles(false);
    	fillPumps();
    	fillSolvent();
    	fillPortACathApplication();
    	
    	fillIntensities();
    	fillReactionSelect();
    	fillPatients();
    	fillNurses();
    	fillDocs();
    	fillStatus();
    	
    	fillTubes();
//    	fillUnits();
    	fillCorrelation();
    	
    }
    
    private void fillTubes() {
        
        DBClass db = new DBClass();
        db.DB_Data_Get.DB_Spalten.Standard.DB_set_Spalten_Einzeln("ID");
        db.DB_Data_Get.DB_Spalten.Standard.DB_set_Spalten_Einzeln("VALUE");

        db.DB_Data_Get.DB_Tabellen.DB_set_Tabelle_Einzeln("cust_protokoll_pop_pump_tubes");
        
        try {
            combo nc = new combo(db.DB_Data_Get.DB_SEND_AND_GET(), pumpTube, "ID", "VALUE");
        } catch (Exception e) {
            pumpTube.removeAllItems();
        }

        pumpTube.setFilteringMode(FilteringMode.CONTAINS);
    }
    
//    private void fillUnits() {
//        
//        mainMedDosageUnit.addItem("ml");
//        mainMedDosageUnit.addItem("mg");
//        mainMedDosageUnit.addItem("IE");
//        mainMedDosageUnit.addItem("G");
//        
//    }
    
    private void fillInfusionTypes() {

        I18nConverter lc = new I18nConverter("cust_protokoll_pop_typ", "ID", "STRING");
        lc.attachDatasource(cbx_type);
        cbx_type.setFilteringMode(FilteringMode.CONTAINS);
    }

    private void fillPunctNeedles(Boolean filtered) {
        
        Object value = punctNeedle.getValue();
        
        DBClass db = new DBClass();
        db.DB_Data_Get.DB_Spalten.Standard.DB_set_Spalten_Einzeln("PNT_ID");
        db.DB_Data_Get.DB_Spalten.Standard.DB_set_Spalten_Einzeln("PNT_NAME");

        db.DB_Data_Get.DB_Tabellen.DB_set_Tabelle_Einzeln("cust_protokoll_nadeltypen");
        if(filtered) {
            
            if(value != null) {
                db.DB_Data_Get.DB_Filter.DB_WHERE_Allgemein("cust_protokoll_nadeltypen", "PNT_ID", "=", value.toString(), "OR");
            }
            
            db.DB_Data_Get.DB_Filter.DB_WHERE_Allgemein("cust_protokoll_nadeltypen", "IS_LEGACY", "=", "0", "");
            
        }
        
//        System.out.println(value);
//        db.debugNextQuery(true);
        
        
        try {
            punctNeedle.removeAllItems();
            combo nc = new combo(db.DB_Data_Get.DB_SEND_AND_GET(), punctNeedle, "PNT_ID", "PNT_NAME");
            if(value != null) {
                punctNeedle.setValue(value);
            }
        } catch (Exception e) {
            punctNeedle.removeAllItems();
        }

        db.DB_Data_Get.connclose();

        punctNeedle.setFilteringMode(FilteringMode.CONTAINS);
       
    }
    
    
    private void fillPumps() {
        
        DBClass db = new DBClass();
        db.DB_Data_Get.DB_Spalten.Standard.DB_set_Spalten_Einzeln("ID");
        db.DB_Data_Get.DB_Spalten.Standard.DB_set_Spalten_Einzeln("NAME");

        db.DB_Data_Get.DB_Tabellen.DB_set_Tabelle_Einzeln("cust_protokoll_pumps");

        try {
            combo nc = new combo(db.DB_Data_Get.DB_SEND_AND_GET(), pumpType, "ID", "NAME");
        } catch (Exception e) {
            pumpType.removeAllItems();
        }

        db.DB_Data_Get.connclose();

        pumpType.setFilteringMode(FilteringMode.CONTAINS);
        
    }

    private void fillSolvent() {
        I18nConverter lc = new I18nConverter("cust_protokoll_solvents", "ID", "TYPE");
        lc.attachDatasource(mainMedSolvent);
        mainMedSolvent.setFilteringMode(FilteringMode.CONTAINS);
    }

    private void fillPortACathApplication() {
    }

    private void fillIntensities() {
        I18nConverter lc = new I18nConverter("cust_protokoll_complications", "PC_ID", "PC_INTENSITY");
        lc.attachDatasource(cbx_reaction_today_intensity);
        lc.attachDatasource(cbx_reaction_recent_intensity);
        cbx_reaction_today_intensity.setFilteringMode(FilteringMode.CONTAINS);
        cbx_reaction_recent_intensity.setFilteringMode(FilteringMode.CONTAINS);
        
    }

    private void fillReactionSelect() {

        HashMap<Boolean, String> map = new HashMap<Boolean, String>();
        map.put(true, i18n.get(caption.lbl_yes));
        map.put(false, i18n.get(caption.lbl_no));
        
        for (Entry<Boolean, String> entry : map.entrySet()) {
            ns_reaction_today.setNullSelectionAllowed(true);
            ns_reaction_today.addItem(entry.getKey());
            ns_reaction_today.setItemCaption(entry.getKey(), entry.getValue());

            ns_reaction_recent.setNullSelectionAllowed(true);
            ns_reaction_recent.addItem(entry.getKey());
            ns_reaction_recent.setItemCaption(entry.getKey(), entry.getValue());
            
        }

    }
    
    private void fillPatients() {

        DBClass db = new DBClass();
        db.DB_Data_Get.DB_Spalten.Standard.DB_set_Spalten_Einzeln("PSL_ID");
        db.DB_Data_Get.DB_Spalten.Standard.DB_set_Spalten_Einzeln(
                "CONCAT(PSL_TITEL,' ',PSA_NAME,' ',PSL_NAME,' ',PSL_VORNAME, ' (',PSL_PLZ, ' ', PSL_ORT,')')", "Patientenname");
        db.DB_Data_Get.DB_Tabellen.DB_set_Tabelle_Verknüpfung("cust_patient_stammdaten_liste", "INNER JOIN", "cust_patient_stammdaten_anrede", "PSL_ANREDE",
                "PSA_ID");
        db.DB_Data_Get.DB_Tabellen.DB_set_Tabelle_Verknüpfung("cust_patient_stammdaten_liste", "INNER JOIN", "cust_verk_haupt", "PSL_ID", "VH_PATIENT_ID");

        db.DB_Data_Get.DB_Filter.DB_WHERE_In("cust_verk_haupt", "VH_PROJEKT_ID", Joiner.on(",").join(projectIds), "");

//        db.debugNextQuery(true);
        
        try {
            combo nc = new combo(db.DB_Data_Get.DB_SEND_AND_GET(), cb_pat, "PSL_ID", "Patientenname");
        } catch (Exception e) {
            cb_pat.removeAllItems();
        }

        db.DB_Data_Get.connclose();

        cb_pat.setFilteringMode(FilteringMode.CONTAINS);
    }

    private void fillNurses() {
        Object nv = null;

        Boolean readonly = cb_nurse.isReadOnly();
        cb_nurse.setReadOnly(false);

        nv = cb_nurse.getValue();
        cb_nurse.removeAllItems();
        
        ProjectNurseCombos pnc = new ProjectNurseCombos(projectIds);
        pnc.setPatientId((Integer) cb_pat.getValue());
        
        try {
            
            new combo(pnc.getNurseComboSubs(), cb_nurse, "KSK_ID", "Krankenschwesternname");
            new combo(pnc.getNurseComboMain(), cb_nurse, "KSK_ID", "Krankenschwesternname");
            //new combo(rnc.getNurseComboSingle(Integer.parseInt(nv.toString())), cb_nurse, "KSK_ID", "Krankenschwesternname");

            if (cb_pat.getValue() != null && nv != null) {
                
                //fix for deleted nurses
                if(!cb_nurse.containsId(nv)){
                    new combo(pnc.getNurseComboSingle(Integer.parseInt(nv.toString())), cb_nurse, "KSK_ID", "Krankenschwesternname");
                    cb_nurse.setEnabled(false);
                    cb_nurse.setStyleName("nogrey");
                }
                
                cb_nurse.select(nv);
            }

        } catch (Exception e) {
            e.printStackTrace();
            cb_nurse.removeAllItems();
            return;
        }

        cb_nurse.setReadOnly(readonly);
    }

    private void fillDocs() {
        Object av = null;

        DBClass db = new DBClass();

        db.DB_Data_Get.DB_Spalten.Standard.DB_set_Spalten_Einzeln("ASA_ID");
        db.DB_Data_Get.DB_Spalten.Standard.DB_set_Spalten_Einzeln("CONCAT(ASA_TITEL,' ',ASAN_NAME,' ',AUL_NAME,' ',AUL_VORNAME)", "Arztname");

        db.DB_Data_Get.DB_Tabellen.DB_set_Tabelle_Verknüpfung("cms_auth_stammdaten_user", "INNER JOIN", "cust_arzt_stammdaten_anrede", "AUL_ANREDE_ID",
                "ASAN_ID");
        db.DB_Data_Get.DB_Tabellen.DB_set_Tabelle_Verknüpfung("cust_arzt_stammdaten_arzt", "INNER JOIN", "cms_auth_stammdaten_user", "ASA_U_ID", "AUL_ID");
        db.DB_Data_Get.DB_Tabellen.DB_set_Tabelle_Verknüpfung("cust_verk_arzt_patient", "INNER JOIN", "cust_arzt_stammdaten_arzt", "VAP_A_ID", "ASA_ID");

        if (cb_pat.getValue() != null) {

            av = cbx_arzt.getValue();
            db.DB_Data_Get.DB_Filter.DB_WHERE_Allgemein("cust_verk_arzt_patient", "VAP_P_ID", "=", Integer.toString((int) cb_pat.getValue()), "AND");
        }

        db.DB_Data_Get.DB_Filter.DB_WHERE_Allgemein("cust_verk_arzt_patient", "VAP_B_ID", "=", "2", "");

        // db.DB_Data_Get.DB_DEBUG_SQL_STRING();

        try {
            cbx_arzt.removeAllItems();
            combo nc = new combo(db.DB_Data_Get.DB_SEND_AND_GET(), cbx_arzt, "ASA_ID", "Arztname");

            if (cb_pat.getValue() != null && av != null) {
                cbx_arzt.select(av);
            }

        } catch (Exception e) {
            cbx_arzt.removeAllItems();
            return;
        }
    }

    private void selectDoc() {
        fillDocs();
        try {
            cbx_arzt.select(Integer.parseInt(getDocId()));
        } catch (Exception e) {
            cbx_arzt.removeAllItems();
        }

    }
    
    private void fillStatus() {
        
        new I18nPoPProcessConverter().attachDatasource(cb_status);
        val.setConstraint(ValidatorType.status_id, cb_status);
        
//        DBClass db = new DBClass();
//        db.DB_Data_Get.DB_Spalten.Standard.DB_set_Spalten_Einzeln("SS_PROZESS");
//        db.DB_Data_Get.DB_Spalten.Standard.DB_set_Spalten_Einzeln("SS_NAME");
//        db.DB_Data_Get.DB_Tabellen.DB_set_Tabelle_Einzeln("cust_schulung_status");
//
//        db.DB_Data_Get.DB_Filter.DB_WHERE_Allgemein("cust_schulung_status", "SS_PROJEKT", "=", "5000", "");
//
//        try {
//            nativecombo nc = new nativecombo(db.DB_Data_Get.DB_SEND_AND_GET(), ns_status, "SS_PROZESS", "SS_NAME");
//        } catch (Exception e) {
//            ns_status.removeAllItems();
//        }
//
//        db.DB_Data_Get.connclose();
        
    }
    
    /******************** Database *****************/
    private void fillDbMap() {
        DBMap = new HashMap<>();
        addToDBMap(pop_date, "DATE");
        addToDBMap(plannedDate, "ORIGINAL_DATE");

        addToDBMap(txt_von, "VON");
        addToDBMap(txt_bis, "BIS");

        addToDBMap(cb_pat, "ID_PATIENT");
        addToDBMap(cb_nurse, "ID_NURSE");
        addToDBMap(cbx_arzt, "ARZT_ID");
        addToDBMap(cb_status, "STATUS");
        
        //addToDBMap(cb_regionalmanager_ok, "REGIONAL_MANAGER_OK");
        cb_regionalmanager_ok.addToDBMap(DBMap, FieldType.CHECK, "cust_protokoll_pop_daten:REGIONAL_MANAGER_OK");
        cb_regionalmanager_ok.addToDBMap(DBMap, FieldType.DATE, "cust_protokoll_pop_daten:REGIONAL_MANAGER_DATE");
        cb_regionalmanager_ok.addToDBMap(DBMap, FieldType.USER, "cust_protokoll_pop_daten:REGIONAL_MANAGER_USER");

        addToDBMap(billingHoursNurse, "FAHRTZEIT_STD_N");
        addToDBMap(billingMinutesNurse, "FAHRTZEIT_MIN_N");

        addToDBMap(billingMinutesCS, "FAHRTZEIT_MIN");
        addToDBMap(billingHoursCS, "FAHRTZEIT_STD");
        addToDBMap(billingKilometersCS, "GES_KM");
        addToDBMap(billingKilometersNurse, "GES_KM_N");
        addToDBMap(cb_admin, "ADMINPAUSCHALE");
        addToDBMap(cb_parallel, "PARALLEL");

        addToDBMap(cbx_type, "INFUSIONSTYP");

        addToDBMap(weigthPatient, "GEW");

        addToDBMap(elbowLeft, "PUNKT_ORT_E_L");
        addToDBMap(elbowRight, "PUNKT_ORT_E_R");
        addToDBMap(handLeft, "PUNKT_ORT_H_L");
        addToDBMap(handRight, "PUNKT_ORT_H_R");
        addToDBMap(armLeft, "PUNKT_ORT_U_L");
        addToDBMap(armRight, "PUNKT_ORT_U_R");
        
        addToDBMap(portACath, "PORT_A_CATH");
        addToDBMap(portACathLeft, "PORT_A_CATH_LEFT");
        addToDBMap(portACathRight, "PORT_A_CATH_RIGHT");
        addToDBMap(portACathNew, "PORT_A_CATH_NEW");
        addToDBMap(portACathReady, "PORT_A_CATH_READY");
        addToDBMap(punctComment, "PUNKT_COMMENT");
        
        addToDBMap(punctTries, "PUNKT_VERS");
        addToDBMap(punctNeedle, "PUNKT_NADEL");
        addToDBMap(pumpType, "PUMP");
        addToDBMap(pumpFilter, "PUMP_FILTER");
        addToDBMap(pumpTube, "PUMP_TUBE");

        addToDBMap(mainMedDosage, "MED_DOSAGE");
//        addToDBMap(mainMedDosageUnit, "MED_DOSAGE_UNIT");
        addToDBMap(mainMedSolvent, "MED_SOLVED_IN");
        addToDBMap(mainMedSolventVolume, "MED_SOLVENT_VOLUME");
        addToDBMap(mainMedVolume, "MED_VOLUME");
        addToDBMap(mainMedFlush, "MED_FLUSH_VOLUME");
        
        addToDBMap(mainMedCount, "DOSIERUNG_AMP");
        
        addToDBMap(ns_reaction_today, "INFUSIONS_REAKTION_HEUTE");
        addToDBMap(ns_reaction_recent, "INFUSIONS_REAKTION_VERG");
        
        addToDBMap(cbx_reaction_today_intensity, "INFUSION_REACTION_TODAY_INTENSITY");
        addToDBMap(cbx_reaction_recent_intensity, "INFUSION_REACTION_RECENT_INTENSITY");
        addToDBMap(ta_reaction_today_desc, "INFUSIONS_REAKTION_HEUTE_BESCHR");
        addToDBMap(ta_reaction_recent_desc, "INFUSIONS_REAKTION_VERG_BESCHR");
        addToDBMap(txta_bemerkungen, "BESONDERHEIT");
        addToDBMap(txta_beobachtungen, "BEOBACHTUNGEN");
        
        addToDBMap(fieldBalanceWasRemoved, "BALANCE_WAS_REMOVED");
        addToDBMap(productSource, "PRODUCT_SOURCE");
        
        addToDBMap(mainMedTotalVolume, "TOTAL_VOLUME");

        addToDBMap(punctPortBlock, "PORT_BLOCK");
        addToDBMap(punctPortDetails, "PORT_DETAILS");
        
        
        addToDBMap(causedBy, "INFUSION_REACTION_CAUSED_BY");
        addToDBMap(correlation, "INFUSION_REACTION_CORRELATION");
        
        
        
    }
    
    private void addToDBMap(AbstractField field, String column) {
        DBMap.put(field, "cust_protokoll_pop_daten:" + column);
    }
    
    private void getProjectIds() {
        
        DBClass db = new DBClass();
        db.CustomQuery.setSqlString("select PSLV_ID"
                         + "\n " + "from cust_projekte_stammdaten_liste"
                         + "\n " + "where PSLV_CODE = 'POP'");
        Container con = db.CustomQuery.query();
        
        projectIds = new ArrayList<Integer>();
        for (Object iid : con.getItemIds()) {
            projectIds.add((Integer) con.getContainerProperty(iid, "PSLV_ID").getValue());
        }
        
    }
    
    private void dbFillForm() {
        DBClass db = new DBClass();
        db.DB_Data_Get.DB_Spalten.Standard.DB_set_Spalten_All();

        /******************************** Table ****************************************/
        db.DB_Data_Get.DB_Tabellen.DB_set_Tabelle_Einzeln(dataTableName);
        /******************************************************************************/
        /******************************** Filter ****************************************/
        db.DB_Data_Get.DB_Filter.DB_WHERE_Allgemein(dataTableName, dataIdCol, "=", dataSetId, "");
        /******************************************************************************/

        // db.DB_Data_Get.Set_Type("SLF_VON_UHRZEIT", Date.class);
        // db.DB_Data_Get.Set_Type("SLF_BIS_UHRZEIT", Date.class);

        Container con = db.DB_Data_Get.DB_SEND_AND_GET_Container();
        fb = new Form_Bind();
        
        if(con.size() > 0){
        	fb.Get_and_Fill(con, DBMap);
        	cb_regionalmanager_ok.init();
        	dataSetItem = con.getItem(con.getItemIds().iterator().next());
        }
        
    }

    private int dbInsert() {
        DBClass db = new DBClass();
        fb = new Form_Bind();
        fb.Insert(db, DBMap);
        
        db.DB_Data_Insert.DB_Daten.DB_Data(dataTableName, "DEVIATES", confirmOptional ? "1" : "0");
        
        /******************************** Table ****************************************/
        db.DB_Data_Insert.DB_Tabellen.DB_set_Tabelle_Einzeln(dataTableName);
        /******************************************************************************/
        // dba.DB_Data_Insert.DB_DEBUG_SQL_STRING();
        return db.DB_Data_Insert.DB_Insert();
    }

    private void dbUpdate() {
        DBClass db = new DBClass();
        fb = new Form_Bind();
        fb.Update(db, DBMap);
        
        db.DB_Data_Update.DB_Daten.DB_Data(dataTableName, "DEVIATES", confirmOptional ? "1" : "0");
        
        /******************************** Table ****************************************/
        db.DB_Data_Update.DB_Tabellen.DB_set_Tabelle_Einzeln(dataTableName);
        /******************************************************************************/
        /******************************** Filter ****************************************/
        db.DB_Data_Update.DB_Filter.DB_WHERE_Allgemein(dataTableName, dataIdCol, "=", dataSetId, "");
        /******************************************************************************/
        db.DB_Data_Update.DB_Update();

    }

    private void checkIsUserNurse() {
        nurse = UserData.get().getNurse().isNurse();
    }

    private int getNurseId() {
        return UserData.get().getNurse().getNurseId();
    }
    
    private String getDocId() {
        String P_ID = cb_pat.getValue().toString();
        DBClass db = new DBClass();
        db.DB_Data_Get.DB_Tabellen.DB_set_Tabelle_Einzeln("cust_verk_arzt_patient");
        db.DB_Data_Get.DB_Spalten.Standard.DB_set_Spalten_All();
        db.DB_Data_Get.DB_Filter.DB_WHERE_Allgemein("cust_verk_arzt_patient", "VAP_P_ID", "=", P_ID, "AND");
        db.DB_Data_Get.DB_Filter.DB_WHERE_Allgemein("cust_verk_arzt_patient", "VAP_B_ID", "=", "2", "");

        Container con = db.DB_Data_Get.DB_SEND_AND_GET_Container();

        int A_ID = 0;
        A_ID = (int) con.getItem(con.getItemIds().iterator().next()).getItemProperty("VAP_A_ID").getValue();

        return A_ID + "";

    }
    
    private Boolean isHomecare(){
        DBClass db = new DBClass();
        db.DB_Data_Get.DB_Spalten.Standard.DB_set_Spalten_Einzeln("PPOPMD_HOMECARE");
        db.DB_Data_Get.DB_Tabellen.DB_set_Tabelle_Verknüpfung("cust_protokoll_pop_daten", "LEFT JOIN", "cust_protokoll_pop_meta_dynamic", "ID_DELEGATION", "PPOPMD_ID");
        db.DB_Data_Get.DB_Filter.DB_WHERE_Allgemein("cust_protokoll_pop_daten", "ID", "=", dataSetId, "");
        
//        db.debugNextQuery(true);
        
        Item item = db.DB_Data_Get.DB_SEND_AND_GET_FIRST_ITEM();
        
        return (item != null && item.getItemProperty("PPOPMD_HOMECARE") != null  &&
                MyUtils.equalsWithNulls(item.getItemProperty("PPOPMD_HOMECARE").getValue(), true)
                );
    }
    
    private void getMetaData() { //TASK missing delegation?
        DBClass db = new DBClass();
        
        Object dlg = null;
        
        if(dataSetItem.getItemProperty("ID_DELEGATION") != null) {
            dlg = dataSetItem.getItemProperty("ID_DELEGATION").getValue();
        }
        
        if(dlg == null) {
            return;
        }
        
        db.CustomQuery.setSqlString("SELECT *"
                         + "\n " + "FROM cust_protokoll_pop_meta_dynamic"
                         + "\n " + "LEFT JOIN cust_protokoll_pop_meta_static on PPOPMD_VH_ID = PPOPMS_VH_ID"
                         + "\n " + "LEFT JOIN cust_verk_haupt on PPOPMD_VH_ID = VH_ID"
                         + "\n " + "LEFT JOIN cust_prescriptions_products on VH_PROJEKT_ID = PP_ID_PROJECT"
                         + "\n " + "WHERE PPOPMD_ID = " + dlg);
        
//        db.debugNextQuery(true);
        
        Container con = db.CustomQuery.query();
        if(con.size() > 0) {
            metaDataItem = con.getItem(con.getItemIds().iterator().next());
            
            if(metaDataItem != null) {
                productId = (Integer) metaDataItem.getItemProperty("PP_ID").getValue();
                val.setConstraint(ValidatorType.product_id, productId);
            }
            
            txt_initials.setValue(MyUtils.getValueFromItem(metaDataItem, "PPOPMS_PAT_INITIALS", String.class));
            
        }
        
        if(metaDataItem != null) {
            
            CustomQuery q = new DBClass().CustomQuery;
            String sql = "select PMP_COUNT from cust_protokoll_meta_products"
             + "\n " + "where PMP_ID_META = " + MyUtils.getValueFromItem(metaDataItem, "PPOPMD_ID", Integer.class)
                     +" and PMP_ID_PROJECT = " + MyUtils.getValueFromItem(metaDataItem, "VH_PROJEKT_ID", Integer.class)
             + "\n " + "order by PMP_ID ASC LIMIT 1";
            q.setSqlString(sql);
            
//            q.db.debugNextQuery(true); 
            
            Container pcon = q.query();
            if(pcon.size() > 0) {
                productDataItem = pcon.getItem(pcon.getItemIds().iterator().next());
            }
            
            
        }
           
        
        
        
    }
    
    private void removeBalance(){
        
        Integer amp = mainMedCount.getValue();
        Integer old = fieldBalanceWasRemoved.getValue();
        
        Boolean wasRemoved = fieldBalanceWasRemoved.getValue() != 0;
        

        if (amp != null &&  cb_status.getValue() != null && (int) cb_status.getValue() > 2) {
            
            if(productSource.affectsBalance() && isHomecare() && !wasRemoved){
                adjustBalance(-1 * amp);
                fieldBalanceWasRemoved.setValue(amp);
                dbUpdate();
            }else{
                
                old = (old == null) ? 0 : old;
                amp = (amp == null || !productSource.affectsBalance()) ? 0 : amp;
                
                Integer diff = old - amp;
                if(diff != 0){
                    adjustBalance(diff);
                    fieldBalanceWasRemoved.setValue(amp);
                    dbUpdate();
                }
                
            }
            
        }
    }
    
    private void adjustBalance(Integer delta){
        
        log.info("adjusting product {} with delta {} for entry {}", productId, delta, dataSetId);
        
        StockPatientBalance balance = new StockPatientBalance();
        balance.setPatientId((Integer) cb_pat.getValue());
        balance.editBalance(productId, delta, StockPatientBalance.INFUSION);
    }
    

    @AutoGenerated
    private VerticalLayout buildMainLayout() {
        // common part: create layout
        mainLayout = new VerticalLayout();
        mainLayout.setStyleName("cust_margin_half_full_none_full");
        mainLayout.setImmediate(false);
        mainLayout.setWidth("100%");
        mainLayout.setHeight("100%");
        mainLayout.setMargin(true);
        
        // top-level component properties
        setWidth("100.0%");
        setHeight("100.0%");
        
        // horizontalLayout_2
        horizontalLayout_2 = buildHorizontalLayout_2();
        mainLayout.addComponent(horizontalLayout_2);
        mainLayout.setExpandRatio(horizontalLayout_2, 2.4f);
        mainLayout.setComponentAlignment(horizontalLayout_2, new Alignment(48));
        
        // horizontalLayout_3
        horizontalLayout_3 = buildHorizontalLayout_3();
        mainLayout.addComponent(horizontalLayout_3);
        mainLayout.setExpandRatio(horizontalLayout_3, 7.0f);
        mainLayout.setComponentAlignment(horizontalLayout_3, new Alignment(48));
        
        // horizontalLayout_4
        horizontalLayout_4 = buildHorizontalLayout_4();
        mainLayout.addComponent(horizontalLayout_4);
        
        // al_localization_labels
        al_localization_labels = buildAl_localization_labels();
        mainLayout.addComponent(al_localization_labels);
        
        // al_passive_fields
        al_passive_fields = buildAl_passive_fields();
        mainLayout.addComponent(al_passive_fields);
        
        return mainLayout;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_2() {
        // common part: create layout
        horizontalLayout_2 = new HorizontalLayout();
        horizontalLayout_2.setImmediate(false);
        horizontalLayout_2.setWidth("100.0%");
        horizontalLayout_2.setHeight("100.0%");
        horizontalLayout_2.setMargin(false);
        
        // pan_dat
        pan_dat = buildPan_dat();
        horizontalLayout_2.addComponent(pan_dat);
        horizontalLayout_2.setExpandRatio(pan_dat, 1.0f);
        
        // pan_stammdaten
        pan_stammdaten = buildPan_stammdaten();
        horizontalLayout_2.addComponent(pan_stammdaten);
        horizontalLayout_2.setExpandRatio(pan_stammdaten, 4.0f);
        horizontalLayout_2.setComponentAlignment(pan_stammdaten, new Alignment(20));
        
        return horizontalLayout_2;
    }

    @AutoGenerated
    private Panel buildPan_dat() {
        // common part: create layout
        pan_dat = new Panel();
        pan_dat.setCaption("Datierung");
        pan_dat.setImmediate(false);
        pan_dat.setWidth("90.0%");
        pan_dat.setHeight("90.0%");
        
        // verticalLayout_2
        verticalLayout_2 = buildVerticalLayout_2();
        pan_dat.setContent(verticalLayout_2);
        
        return pan_dat;
    }

    @AutoGenerated
    private VerticalLayout buildVerticalLayout_2() {
        // common part: create layout
        verticalLayout_2 = new VerticalLayout();
        verticalLayout_2.setImmediate(false);
        verticalLayout_2.setWidth("100.0%");
        verticalLayout_2.setHeight("100.0%");
        verticalLayout_2.setMargin(false);
        
        // plannedDate
        plannedDate = new PopupDateField();
        plannedDate.setCaption("Plandatum");
        plannedDate.setImmediate(false);
        plannedDate.setWidth("80.0%");
        plannedDate.setHeight("-1px");
        verticalLayout_2.addComponent(plannedDate);
        verticalLayout_2.setExpandRatio(plannedDate, 1.5f);
        verticalLayout_2.setComponentAlignment(plannedDate, new Alignment(48));
        
        // pop_date
        pop_date = new PopupDateField();
        pop_date.setCaption("Datum");
        pop_date.setImmediate(false);
        pop_date.setWidth("80.0%");
        pop_date.setHeight("-1px");
        verticalLayout_2.addComponent(pop_date);
        verticalLayout_2.setExpandRatio(pop_date, 2.0f);
        verticalLayout_2.setComponentAlignment(pop_date, new Alignment(48));
        
        // horizontalLayout_11
        horizontalLayout_11 = buildHorizontalLayout_11();
        verticalLayout_2.addComponent(horizontalLayout_11);
        verticalLayout_2.setExpandRatio(horizontalLayout_11, 2.0f);
        verticalLayout_2.setComponentAlignment(horizontalLayout_11, new Alignment(48));
        
        return verticalLayout_2;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_11() {
        // common part: create layout
        horizontalLayout_11 = new HorizontalLayout();
        horizontalLayout_11.setImmediate(false);
        horizontalLayout_11.setWidth("-1px");
        horizontalLayout_11.setHeight("-1px");
        horizontalLayout_11.setMargin(false);
        horizontalLayout_11.setSpacing(true);
        
        // txt_von
        txt_von = new CustomTimePicker();
        txt_von.setCaption("Von");
        txt_von.setImmediate(false);
        txt_von.setWidth("64px");
        txt_von.setHeight("-1px");
        horizontalLayout_11.addComponent(txt_von);
        
        // txt_bis
        txt_bis = new CustomTimePicker();
        txt_bis.setCaption("Bis");
        txt_bis.setImmediate(false);
        txt_bis.setWidth("64px");
        txt_bis.setHeight("-1px");
        horizontalLayout_11.addComponent(txt_bis);
        
        return horizontalLayout_11;
    }

    @AutoGenerated
    private Panel buildPan_stammdaten() {
        // common part: create layout
        pan_stammdaten = new Panel();
        pan_stammdaten.setCaption("Stammdatenauswahl");
        pan_stammdaten.setImmediate(false);
        pan_stammdaten.setWidth("100.0%");
        pan_stammdaten.setHeight("90.0%");
        
        // horizontalLayout_1
        horizontalLayout_1 = buildHorizontalLayout_1();
        pan_stammdaten.setContent(horizontalLayout_1);
        
        return pan_stammdaten;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_1() {
        // common part: create layout
        horizontalLayout_1 = new HorizontalLayout();
        horizontalLayout_1.setImmediate(false);
        horizontalLayout_1.setWidth("100.0%");
        horizontalLayout_1.setHeight("100.0%");
        horizontalLayout_1.setMargin(false);
        
        // verticalLayout_3
        verticalLayout_3 = buildVerticalLayout_3();
        horizontalLayout_1.addComponent(verticalLayout_3);
        horizontalLayout_1.setExpandRatio(verticalLayout_3, 3.0f);
        
        // verticalLayout_16
        verticalLayout_16 = buildVerticalLayout_16();
        horizontalLayout_1.addComponent(verticalLayout_16);
        horizontalLayout_1.setComponentAlignment(verticalLayout_16, new Alignment(34));
        
        return horizontalLayout_1;
    }

    @AutoGenerated
    private VerticalLayout buildVerticalLayout_3() {
        // common part: create layout
        verticalLayout_3 = new VerticalLayout();
        verticalLayout_3.setImmediate(false);
        verticalLayout_3.setWidth("100.0%");
        verticalLayout_3.setHeight("100.0%");
        verticalLayout_3.setMargin(false);
        
        // horizontalLayout_8
        horizontalLayout_8 = buildHorizontalLayout_8();
        verticalLayout_3.addComponent(horizontalLayout_8);
        verticalLayout_3.setExpandRatio(horizontalLayout_8, 1.0f);
        verticalLayout_3.setComponentAlignment(horizontalLayout_8, new Alignment(33));
        
        // horizontalLayout_9
        horizontalLayout_9 = buildHorizontalLayout_9();
        verticalLayout_3.addComponent(horizontalLayout_9);
        verticalLayout_3.setExpandRatio(horizontalLayout_9, 1.0f);
        verticalLayout_3.setComponentAlignment(horizontalLayout_9, new Alignment(33));
        
        return verticalLayout_3;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_8() {
        // common part: create layout
        horizontalLayout_8 = new HorizontalLayout();
        horizontalLayout_8.setImmediate(false);
        horizontalLayout_8.setWidth("100.0%");
        horizontalLayout_8.setHeight("-1px");
        horizontalLayout_8.setMargin(false);
        horizontalLayout_8.setSpacing(true);
        
        // verticalLayout_4
        verticalLayout_4 = buildVerticalLayout_4();
        horizontalLayout_8.addComponent(verticalLayout_4);
        horizontalLayout_8.setComponentAlignment(verticalLayout_4, new Alignment(9));
        
        // txt_initials
        txt_initials = new TextField();
        txt_initials.setCaption("Kürzel");
        txt_initials.setImmediate(false);
        txt_initials.setWidth("60px");
        txt_initials.setHeight("-1px");
        horizontalLayout_8.addComponent(txt_initials);
        horizontalLayout_8.setComponentAlignment(txt_initials, new Alignment(9));
        
        // cb_pat
        cb_pat = new ComboBox();
        cb_pat.setCaption("Patientauswahl");
        cb_pat.setImmediate(false);
        cb_pat.setWidth("-1px");
        cb_pat.setHeight("-1px");
        horizontalLayout_8.addComponent(cb_pat);
        horizontalLayout_8.setExpandRatio(cb_pat, 1.0f);
        horizontalLayout_8.setComponentAlignment(cb_pat, new Alignment(9));
        
        return horizontalLayout_8;
    }

    @AutoGenerated
    private VerticalLayout buildVerticalLayout_4() {
        // common part: create layout
        verticalLayout_4 = new VerticalLayout();
        verticalLayout_4.setImmediate(false);
        verticalLayout_4.setWidth("50px");
        verticalLayout_4.setHeight("-1px");
        verticalLayout_4.setMargin(false);
        
        // btn_pat_info
        btn_pat_info = new Button();
        btn_pat_info.setCaption("Button");
        btn_pat_info.setImmediate(true);
        btn_pat_info.setWidth("-1px");
        btn_pat_info.setHeight("-1px");
        verticalLayout_4.addComponent(btn_pat_info);
        verticalLayout_4.setComponentAlignment(btn_pat_info, new Alignment(20));
        
        return verticalLayout_4;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_9() {
        // common part: create layout
        horizontalLayout_9 = new HorizontalLayout();
        horizontalLayout_9.setImmediate(false);
        horizontalLayout_9.setWidth("100.0%");
        horizontalLayout_9.setHeight("-1px");
        horizontalLayout_9.setMargin(false);
        horizontalLayout_9.setSpacing(true);
        
        // verticalLayout_6
        verticalLayout_6 = buildVerticalLayout_6();
        horizontalLayout_9.addComponent(verticalLayout_6);
        horizontalLayout_9.setComponentAlignment(verticalLayout_6, new Alignment(9));
        
        // verticalLayout_9
        verticalLayout_9 = buildVerticalLayout_9();
        horizontalLayout_9.addComponent(verticalLayout_9);
        horizontalLayout_9.setComponentAlignment(verticalLayout_9, new Alignment(9));
        
        // cb_nurse
        cb_nurse = new ComboBox();
        cb_nurse.setCaption("Krankenschwester");
        cb_nurse.setImmediate(false);
        cb_nurse.setWidth("-1px");
        cb_nurse.setHeight("-1px");
        horizontalLayout_9.addComponent(cb_nurse);
        horizontalLayout_9.setExpandRatio(cb_nurse, 1.0f);
        horizontalLayout_9.setComponentAlignment(cb_nurse, new Alignment(9));
        
        return horizontalLayout_9;
    }

    @AutoGenerated
    private VerticalLayout buildVerticalLayout_6() {
        // common part: create layout
        verticalLayout_6 = new VerticalLayout();
        verticalLayout_6.setImmediate(false);
        verticalLayout_6.setWidth("50px");
        verticalLayout_6.setHeight("-1px");
        verticalLayout_6.setMargin(false);
        
        // btn_nurse_info
        btn_nurse_info = new Button();
        btn_nurse_info.setCaption("Button");
        btn_nurse_info.setImmediate(true);
        btn_nurse_info.setWidth("-1px");
        btn_nurse_info.setHeight("-1px");
        verticalLayout_6.addComponent(btn_nurse_info);
        verticalLayout_6.setComponentAlignment(btn_nurse_info, new Alignment(20));
        
        return verticalLayout_6;
    }

    @AutoGenerated
    private VerticalLayout buildVerticalLayout_9() {
        // common part: create layout
        verticalLayout_9 = new VerticalLayout();
        verticalLayout_9.setImmediate(false);
        verticalLayout_9.setWidth("-1px");
        verticalLayout_9.setHeight("-1px");
        verticalLayout_9.setMargin(false);
        
        // btn_zuweisung
        btn_zuweisung = new Button();
        btn_zuweisung.setCaption("Zuweisung");
        btn_zuweisung.setImmediate(true);
        btn_zuweisung.setWidth("-1px");
        btn_zuweisung.setHeight("-1px");
        verticalLayout_9.addComponent(btn_zuweisung);
        
        return verticalLayout_9;
    }

    @AutoGenerated
    private VerticalLayout buildVerticalLayout_16() {
        // common part: create layout
        verticalLayout_16 = new VerticalLayout();
        verticalLayout_16.setImmediate(false);
        verticalLayout_16.setWidth("180px");
        verticalLayout_16.setHeight("100.0%");
        verticalLayout_16.setMargin(false);
        
        // horizontalLayout_7
        horizontalLayout_7 = buildHorizontalLayout_7();
        verticalLayout_16.addComponent(horizontalLayout_7);
        verticalLayout_16.setExpandRatio(horizontalLayout_7, 1.0f);
        verticalLayout_16.setComponentAlignment(horizontalLayout_7, new Alignment(34));
        
        // horizontalLayout_14
        horizontalLayout_14 = buildHorizontalLayout_14();
        verticalLayout_16.addComponent(horizontalLayout_14);
        verticalLayout_16.setExpandRatio(horizontalLayout_14, 1.0f);
        verticalLayout_16.setComponentAlignment(horizontalLayout_14, new Alignment(34));
        
        // horizontalLayout_17
        horizontalLayout_17 = buildHorizontalLayout_17();
        verticalLayout_16.addComponent(horizontalLayout_17);
        verticalLayout_16.setExpandRatio(horizontalLayout_17, 1.0f);
        verticalLayout_16.setComponentAlignment(horizontalLayout_17, new Alignment(34));
        
        return verticalLayout_16;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_7() {
        // common part: create layout
        horizontalLayout_7 = new HorizontalLayout();
        horizontalLayout_7.setImmediate(false);
        horizontalLayout_7.setWidth("100.0%");
        horizontalLayout_7.setHeight("100.0%");
        horizontalLayout_7.setMargin(false);
        
        // cb_status
        cb_status = new ComboBox();
        cb_status.setCaption("Protokollstatus");
        cb_status.setImmediate(true);
        cb_status.setWidth("170px");
        cb_status.setHeight("-1px");
        horizontalLayout_7.addComponent(cb_status);
        horizontalLayout_7.setExpandRatio(cb_status, 3.0f);
        horizontalLayout_7.setComponentAlignment(cb_status, new Alignment(33));
        
        return horizontalLayout_7;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_14() {
        // common part: create layout
        horizontalLayout_14 = new HorizontalLayout();
        horizontalLayout_14.setImmediate(false);
        horizontalLayout_14.setWidth("100.0%");
        horizontalLayout_14.setHeight("100.0%");
        horizontalLayout_14.setMargin(false);
        
        // cbx_arzt
        cbx_arzt = new ComboBox();
        cbx_arzt.setCaption("Delegierender Arzt");
        cbx_arzt.setImmediate(false);
        cbx_arzt.setWidth("170px");
        cbx_arzt.setHeight("-1px");
        horizontalLayout_14.addComponent(cbx_arzt);
        horizontalLayout_14.setComponentAlignment(cbx_arzt, new Alignment(33));
        
        return horizontalLayout_14;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_17() {
        // common part: create layout
        horizontalLayout_17 = new HorizontalLayout();
        horizontalLayout_17.setImmediate(false);
        horizontalLayout_17.setWidth("100.0%");
        horizontalLayout_17.setHeight("100.0%");
        horizontalLayout_17.setMargin(false);
        
        // cb_regionalmanager_ok
        cb_regionalmanager_ok = new RegionalLeadCheck();
        cb_regionalmanager_ok.setCaption("Regionalleiter Ok");
        cb_regionalmanager_ok.setImmediate(false);
        cb_regionalmanager_ok.setWidth("-1px");
        cb_regionalmanager_ok.setHeight("-1px");
        horizontalLayout_17.addComponent(cb_regionalmanager_ok);
        horizontalLayout_17.setComponentAlignment(cb_regionalmanager_ok, new Alignment(33));
        
        return horizontalLayout_17;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_3() {
        // common part: create layout
        horizontalLayout_3 = new HorizontalLayout();
        horizontalLayout_3.setImmediate(false);
        horizontalLayout_3.setWidth("100.0%");
        horizontalLayout_3.setHeight("100.0%");
        horizontalLayout_3.setMargin(false);
        
        // pan_abrechnungsdaten
        pan_abrechnungsdaten = buildPan_abrechnungsdaten();
        horizontalLayout_3.addComponent(pan_abrechnungsdaten);
        horizontalLayout_3.setExpandRatio(pan_abrechnungsdaten, 0.74f);
        horizontalLayout_3.setComponentAlignment(pan_abrechnungsdaten, new Alignment(48));
        
        // pan_BesD
        pan_BesD = buildPan_BesD();
        horizontalLayout_3.addComponent(pan_BesD);
        horizontalLayout_3.setExpandRatio(pan_BesD, 4.0f);
        
        return horizontalLayout_3;
    }

    @AutoGenerated
    private Panel buildPan_abrechnungsdaten() {
        // common part: create layout
        pan_abrechnungsdaten = new Panel();
        pan_abrechnungsdaten.setCaption("Abrechnungsdaten");
        pan_abrechnungsdaten.setImmediate(false);
        pan_abrechnungsdaten.setWidth("100.0%");
        pan_abrechnungsdaten.setHeight("100.0%");
        
        // verticalLayout_5
        verticalLayout_5 = buildVerticalLayout_5();
        pan_abrechnungsdaten.setContent(verticalLayout_5);
        
        return pan_abrechnungsdaten;
    }

    @AutoGenerated
    private VerticalLayout buildVerticalLayout_5() {
        // common part: create layout
        verticalLayout_5 = new VerticalLayout();
        verticalLayout_5.setImmediate(false);
        verticalLayout_5.setWidth("100.0%");
        verticalLayout_5.setHeight("100.0%");
        verticalLayout_5.setMargin(false);
        verticalLayout_5.setSpacing(true);
        
        // gridLayout_2
        gridLayout_2 = buildGridLayout_2();
        verticalLayout_5.addComponent(gridLayout_2);
        verticalLayout_5.setExpandRatio(gridLayout_2, 1.0f);
        verticalLayout_5.setComponentAlignment(gridLayout_2, new Alignment(48));
        
        return verticalLayout_5;
    }

    @AutoGenerated
    private GridLayout buildGridLayout_2() {
        // common part: create layout
        gridLayout_2 = new GridLayout();
        gridLayout_2.setImmediate(false);
        gridLayout_2.setWidth("-1px");
        gridLayout_2.setHeight("95.0%");
        gridLayout_2.setMargin(false);
        gridLayout_2.setRows(4);
        
        // vl_nurse
        vl_nurse = buildVl_nurse();
        gridLayout_2.addComponent(vl_nurse, 0, 0);
        gridLayout_2.setComponentAlignment(vl_nurse, new Alignment(33));
        
        // btn_km_ber
        btn_km_ber = new Button();
        btn_km_ber.setCaption("Button");
        btn_km_ber.setImmediate(true);
        btn_km_ber.setWidth("-1px");
        btn_km_ber.setHeight("-1px");
        gridLayout_2.addComponent(btn_km_ber, 0, 1);
        gridLayout_2.setComponentAlignment(btn_km_ber, new Alignment(20));
        
        // vl_cs
        vl_cs = buildVl_cs();
        gridLayout_2.addComponent(vl_cs, 0, 2);
        gridLayout_2.setComponentAlignment(vl_cs, new Alignment(33));
        
        // verticalLayout_8
        verticalLayout_8 = buildVerticalLayout_8();
        gridLayout_2.addComponent(verticalLayout_8, 0, 3);
        gridLayout_2.setComponentAlignment(verticalLayout_8, new Alignment(48));
        
        return gridLayout_2;
    }

    @AutoGenerated
    private VerticalLayout buildVl_nurse() {
        // common part: create layout
        vl_nurse = new VerticalLayout();
        vl_nurse.setCaption("Fahrzeit Nurse");
        vl_nurse.setImmediate(false);
        vl_nurse.setWidth("-1px");
        vl_nurse.setHeight("-1px");
        vl_nurse.setMargin(false);
        vl_nurse.setSpacing(true);
        
        // horizontalLayout_10
        horizontalLayout_10 = buildHorizontalLayout_10();
        vl_nurse.addComponent(horizontalLayout_10);
        
        // billingKilometersNurse
        billingKilometersNurse = new IntStepper();
        billingKilometersNurse.setCaption("Gesamte km");
        billingKilometersNurse.setImmediate(false);
        billingKilometersNurse.setWidth("100px");
        billingKilometersNurse.setHeight("-1px");
        vl_nurse.addComponent(billingKilometersNurse);
        vl_nurse.setComponentAlignment(billingKilometersNurse, new Alignment(48));
        
        return vl_nurse;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_10() {
        // common part: create layout
        horizontalLayout_10 = new HorizontalLayout();
        horizontalLayout_10.setImmediate(false);
        horizontalLayout_10.setWidth("-1px");
        horizontalLayout_10.setHeight("-1px");
        horizontalLayout_10.setMargin(false);
        horizontalLayout_10.setSpacing(true);
        
        // billingHoursNurse
        billingHoursNurse = new IntStepper();
        billingHoursNurse.setCaption("Stunden");
        billingHoursNurse.setImmediate(false);
        billingHoursNurse.setWidth("-1px");
        billingHoursNurse.setHeight("-1px");
        horizontalLayout_10.addComponent(billingHoursNurse);
        
        // billingMinutesNurse
        billingMinutesNurse = new IntStepper();
        billingMinutesNurse.setCaption("Minuten");
        billingMinutesNurse.setImmediate(false);
        billingMinutesNurse.setWidth("-1px");
        billingMinutesNurse.setHeight("-1px");
        horizontalLayout_10.addComponent(billingMinutesNurse);
        
        return horizontalLayout_10;
    }

    @AutoGenerated
    private VerticalLayout buildVl_cs() {
        // common part: create layout
        vl_cs = new VerticalLayout();
        vl_cs.setCaption("Abgerechnet");
        vl_cs.setImmediate(false);
        vl_cs.setWidth("-1px");
        vl_cs.setHeight("-1px");
        vl_cs.setMargin(false);
        vl_cs.setSpacing(true);
        
        // horizontalLayout_5
        horizontalLayout_5 = buildHorizontalLayout_5();
        vl_cs.addComponent(horizontalLayout_5);
        
        // billingKilometersCS
        billingKilometersCS = new IntStepper();
        billingKilometersCS.setCaption("Abgerechnete km");
        billingKilometersCS.setImmediate(false);
        billingKilometersCS.setWidth("100px");
        billingKilometersCS.setHeight("-1px");
        vl_cs.addComponent(billingKilometersCS);
        vl_cs.setComponentAlignment(billingKilometersCS, new Alignment(48));
        
        return vl_cs;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_5() {
        // common part: create layout
        horizontalLayout_5 = new HorizontalLayout();
        horizontalLayout_5.setImmediate(false);
        horizontalLayout_5.setWidth("-1px");
        horizontalLayout_5.setHeight("-1px");
        horizontalLayout_5.setMargin(false);
        horizontalLayout_5.setSpacing(true);
        
        // billingHoursCS
        billingHoursCS = new IntStepper();
        billingHoursCS.setCaption("Stunden");
        billingHoursCS.setImmediate(false);
        billingHoursCS.setWidth("-1px");
        billingHoursCS.setHeight("-1px");
        horizontalLayout_5.addComponent(billingHoursCS);
        
        // billingMinutesCS
        billingMinutesCS = new IntStepper();
        billingMinutesCS.setCaption("Minuten");
        billingMinutesCS.setImmediate(false);
        billingMinutesCS.setWidth("-1px");
        billingMinutesCS.setHeight("-1px");
        horizontalLayout_5.addComponent(billingMinutesCS);
        
        return horizontalLayout_5;
    }

    @AutoGenerated
    private VerticalLayout buildVerticalLayout_8() {
        // common part: create layout
        verticalLayout_8 = new VerticalLayout();
        verticalLayout_8.setImmediate(false);
        verticalLayout_8.setWidth("-1px");
        verticalLayout_8.setHeight("-1px");
        verticalLayout_8.setMargin(false);
        verticalLayout_8.setSpacing(true);
        
        // cb_admin
        cb_admin = new CheckBox();
        cb_admin.setCaption("Admin Pauschale");
        cb_admin.setImmediate(false);
        cb_admin.setWidth("-1px");
        cb_admin.setHeight("-1px");
        verticalLayout_8.addComponent(cb_admin);
        
        // cb_parallel
        cb_parallel = new CheckBox();
        cb_parallel.setCaption("Parallel-Infusion");
        cb_parallel.setImmediate(false);
        cb_parallel.setWidth("-1px");
        cb_parallel.setHeight("-1px");
        verticalLayout_8.addComponent(cb_parallel);
        
        return verticalLayout_8;
    }

    @AutoGenerated
    private TabSheet buildPan_BesD() {
        // common part: create layout
        pan_BesD = new TabSheet();
        pan_BesD.setCaption("Besuchsdetails");
        pan_BesD.setImmediate(true);
        pan_BesD.setWidth("100.0%");
        pan_BesD.setHeight("100.0%");
        
        // vl_preinfo
        vl_preinfo = buildVl_preinfo();
        pan_BesD.addTab(vl_preinfo, "Vorabinformationen", null);
        
        // vl_inf
        vl_inf = buildVl_inf();
        pan_BesD.addTab(vl_inf, "Infusion", null);
        
        // vl_events
        vl_events = buildVl_events();
        pan_BesD.addTab(vl_events, "Unerwünschte Ereignisse", null);
        
        // vl_comments
        vl_comments = buildVl_comments();
        pan_BesD.addTab(vl_comments, "Kommentare", null);
        
        return pan_BesD;
    }

    @AutoGenerated
    private VerticalLayout buildVl_preinfo() {
        // common part: create layout
        vl_preinfo = new VerticalLayout();
        vl_preinfo.setImmediate(false);
        vl_preinfo.setWidth("100.0%");
        vl_preinfo.setHeight("100.0%");
        vl_preinfo.setMargin(true);
        
        // horizontalLayout_13
        horizontalLayout_13 = buildHorizontalLayout_13();
        vl_preinfo.addComponent(horizontalLayout_13);
        vl_preinfo.setExpandRatio(horizontalLayout_13, 1.0f);
        
        return vl_preinfo;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_13() {
        // common part: create layout
        horizontalLayout_13 = new HorizontalLayout();
        horizontalLayout_13.setImmediate(false);
        horizontalLayout_13.setWidth("100.0%");
        horizontalLayout_13.setHeight("-1px");
        horizontalLayout_13.setMargin(false);
        
        // cbx_type
        cbx_type = new ComboBox();
        cbx_type.setCaption("Infusionstyp");
        cbx_type.setImmediate(false);
        cbx_type.setWidth("-1px");
        cbx_type.setHeight("-1px");
        horizontalLayout_13.addComponent(cbx_type);
        horizontalLayout_13.setExpandRatio(cbx_type, 1.0f);
        
        // verticalLayout_7
        verticalLayout_7 = buildVerticalLayout_7();
        horizontalLayout_13.addComponent(verticalLayout_7);
        horizontalLayout_13.setExpandRatio(verticalLayout_7, 1.0f);
        horizontalLayout_13.setComponentAlignment(verticalLayout_7, new Alignment(33));
        
        return horizontalLayout_13;
    }

    @AutoGenerated
    private VerticalLayout buildVerticalLayout_7() {
        // common part: create layout
        verticalLayout_7 = new VerticalLayout();
        verticalLayout_7.setImmediate(false);
        verticalLayout_7.setWidth("-1px");
        verticalLayout_7.setHeight("-1px");
        verticalLayout_7.setMargin(false);
        
        // weigthPatient
        weigthPatient = new FloatStepper();
        weigthPatient.setCaption("Körpergewicht");
        weigthPatient.setImmediate(false);
        weigthPatient.setWidth("-1px");
        weigthPatient.setHeight("-1px");
        verticalLayout_7.addComponent(weigthPatient);
        
        // lbl_weight
        lbl_weight = new Label();
        lbl_weight.setImmediate(false);
        lbl_weight.setWidth("-1px");
        lbl_weight.setHeight("-1px");
        lbl_weight.setValue("Vor 1. und 13. Heiminfusion, ab 12 Monaten 1x jährlich");
        verticalLayout_7.addComponent(lbl_weight);
        
        return verticalLayout_7;
    }

    @AutoGenerated
    private VerticalLayout buildVl_inf() {
        // common part: create layout
        vl_inf = new VerticalLayout();
        vl_inf.setImmediate(false);
        vl_inf.setWidth("100.0%");
        vl_inf.setHeight("100.0%");
        vl_inf.setMargin(false);
        
        // tab_inf
        tab_inf = buildTab_inf();
        vl_inf.addComponent(tab_inf);
        
        return vl_inf;
    }

    @AutoGenerated
    private TabSheet buildTab_inf() {
        // common part: create layout
        tab_inf = new TabSheet();
        tab_inf.setImmediate(true);
        tab_inf.setWidth("100.0%");
        tab_inf.setHeight("100.0%");
        
        // layoutPremed
        layoutPremed = buildLayoutPremed();
        tab_inf.addTab(layoutPremed, "Prämedikation", null);
        
        // layoutInfusion
        layoutInfusion = buildLayoutInfusion();
        tab_inf.addTab(layoutInfusion, "Hauptmedikament", null);
        
        // layoutCharges
        layoutCharges = buildLayoutCharges();
        tab_inf.addTab(layoutCharges, "Chargen", null);
        
        // layoutTimes
        layoutTimes = buildLayoutTimes();
        tab_inf.addTab(layoutTimes, "Infusionszeiten", null);
        
        // layoutVitals
        layoutVitals = buildLayoutVitals();
        tab_inf.addTab(layoutVitals, "Vitalzeichen", null);
        
        // layoutPostmed
        layoutPostmed = buildLayoutPostmed();
        tab_inf.addTab(layoutPostmed, "Postmedikation", null);
        
        return tab_inf;
    }

    @AutoGenerated
    private VerticalLayout buildLayoutPremed() {
        // common part: create layout
        layoutPremed = new VerticalLayout();
        layoutPremed.setImmediate(false);
        layoutPremed.setWidth("100.0%");
        layoutPremed.setHeight("100.0%");
        layoutPremed.setMargin(false);
        
        // panelPreMed
        panelPreMed = new PanelPreMed();
        panelPreMed.setImmediate(false);
        panelPreMed.setWidth("100.0%");
        panelPreMed.setHeight("100.0%");
        layoutPremed.addComponent(panelPreMed);
        layoutPremed.setComponentAlignment(panelPreMed, new Alignment(48));
        
        return layoutPremed;
    }

    @AutoGenerated
    private VerticalLayout buildLayoutInfusion() {
        // common part: create layout
        layoutInfusion = new VerticalLayout();
        layoutInfusion.setImmediate(false);
        layoutInfusion.setWidth("100.0%");
        layoutInfusion.setHeight("100.0%");
        layoutInfusion.setMargin(false);
        
        // horizontalLayout_6
        horizontalLayout_6 = buildHorizontalLayout_6();
        layoutInfusion.addComponent(horizontalLayout_6);
        
        return layoutInfusion;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_6() {
        // common part: create layout
        horizontalLayout_6 = new HorizontalLayout();
        horizontalLayout_6.setImmediate(false);
        horizontalLayout_6.setWidth("100.0%");
        horizontalLayout_6.setHeight("100.0%");
        horizontalLayout_6.setMargin(false);
        horizontalLayout_6.setSpacing(true);
        
        // layoutMainMed
        layoutMainMed = buildLayoutMainMed();
        horizontalLayout_6.addComponent(layoutMainMed);
        horizontalLayout_6.setExpandRatio(layoutMainMed, 3.0f);
        
        return horizontalLayout_6;
    }

    @AutoGenerated
    private VerticalLayout buildLayoutMainMed() {
        // common part: create layout
        layoutMainMed = new VerticalLayout();
        layoutMainMed.setImmediate(false);
        layoutMainMed.setWidth("100.0%");
        layoutMainMed.setHeight("-1px");
        layoutMainMed.setMargin(false);
        
        // layoutPunct
        layoutPunct = buildLayoutPunct();
        layoutMainMed.addComponent(layoutPunct);
        
        // layoutMainMedInfo
        layoutMainMedInfo = buildLayoutMainMedInfo();
        layoutMainMed.addComponent(layoutMainMedInfo);
        
        return layoutMainMed;
    }

    @AutoGenerated
    private HorizontalLayout buildLayoutPunct() {
        // common part: create layout
        layoutPunct = new HorizontalLayout();
        layoutPunct.setStyleName("cust_margin_half_full_none_full");
        layoutPunct.setImmediate(false);
        layoutPunct.setWidth("100.0%");
        layoutPunct.setHeight("-1px");
        layoutPunct.setMargin(true);
        layoutPunct.setSpacing(true);
        
        // layoutPunctLeft
        layoutPunctLeft = buildLayoutPunctLeft();
        layoutPunct.addComponent(layoutPunctLeft);
        
        // layoutPunctRight
        layoutPunctRight = buildLayoutPunctRight();
        layoutPunct.addComponent(layoutPunctRight);
        
        return layoutPunct;
    }

    @AutoGenerated
    private VerticalLayout buildLayoutPunctLeft() {
        // common part: create layout
        layoutPunctLeft = new VerticalLayout();
        layoutPunctLeft.setImmediate(false);
        layoutPunctLeft.setWidth("100.0%");
        layoutPunctLeft.setHeight("-1px");
        layoutPunctLeft.setMargin(false);
        layoutPunctLeft.setSpacing(true);
        
        // horizontalLayout_16
        horizontalLayout_16 = buildHorizontalLayout_16();
        layoutPunctLeft.addComponent(horizontalLayout_16);
        
        // pumpType
        pumpType = new ComboBox();
        pumpType.setCaption("Infusionspumpe");
        pumpType.setImmediate(false);
        pumpType.setWidth("100.0%");
        pumpType.setHeight("-1px");
        layoutPunctLeft.addComponent(pumpType);
        
        // pumpTube
        pumpTube = new ComboBox();
        pumpTube.setCaption("Pumpenleitung");
        pumpTube.setImmediate(false);
        pumpTube.setWidth("100.0%");
        pumpTube.setHeight("-1px");
        layoutPunctLeft.addComponent(pumpTube);
        
        // pumpFilter
        pumpFilter = new CheckBox();
        pumpFilter.setCaption("Filter 0,2 µm");
        pumpFilter.setImmediate(false);
        pumpFilter.setWidth("-1px");
        pumpFilter.setHeight("-1px");
        layoutPunctLeft.addComponent(pumpFilter);
        
        return layoutPunctLeft;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_16() {
        // common part: create layout
        horizontalLayout_16 = new HorizontalLayout();
        horizontalLayout_16.setImmediate(false);
        horizontalLayout_16.setWidth("100.0%");
        horizontalLayout_16.setHeight("-1px");
        horizontalLayout_16.setMargin(false);
        horizontalLayout_16.setSpacing(true);
        
        // punctTries
        punctTries = new IntStepper();
        punctTries.setCaption("Punktionsversuche");
        punctTries.setImmediate(false);
        punctTries.setWidth("60px");
        punctTries.setHeight("-1px");
        horizontalLayout_16.addComponent(punctTries);
        
        // punctNeedle
        punctNeedle = new ComboBox();
        punctNeedle.setCaption("Punktionsnadel");
        punctNeedle.setImmediate(false);
        punctNeedle.setWidth("100.0%");
        punctNeedle.setHeight("-1px");
        horizontalLayout_16.addComponent(punctNeedle);
        horizontalLayout_16.setExpandRatio(punctNeedle, 1.0f);
        
        return horizontalLayout_16;
    }

    @AutoGenerated
    private VerticalLayout buildLayoutPunctRight() {
        // common part: create layout
        layoutPunctRight = new VerticalLayout();
        layoutPunctRight.setImmediate(false);
        layoutPunctRight.setWidth("200px");
        layoutPunctRight.setHeight("-1px");
        layoutPunctRight.setMargin(false);
        layoutPunctRight.setSpacing(true);
        
        // labelPunctPosition
        labelPunctPosition = new Label();
        labelPunctPosition.setImmediate(false);
        labelPunctPosition.setWidth("-1px");
        labelPunctPosition.setHeight("-1px");
        labelPunctPosition.setValue("Punktionsort");
        layoutPunctRight.addComponent(labelPunctPosition);
        
        // layoutPunctElbow
        layoutPunctElbow = buildLayoutPunctElbow();
        layoutPunctRight.addComponent(layoutPunctElbow);
        
        // layoutPunctHand
        layoutPunctHand = buildLayoutPunctHand();
        layoutPunctRight.addComponent(layoutPunctHand);
        
        // layoutPunctArm
        layoutPunctArm = buildLayoutPunctArm();
        layoutPunctRight.addComponent(layoutPunctArm);
        
        // layoutPunctPortACath
        layoutPunctPortACath = buildLayoutPunctPortACath();
        layoutPunctRight.addComponent(layoutPunctPortACath);
        
        return layoutPunctRight;
    }

    @AutoGenerated
    private HorizontalLayout buildLayoutPunctElbow() {
        // common part: create layout
        layoutPunctElbow = new HorizontalLayout();
        layoutPunctElbow.setImmediate(false);
        layoutPunctElbow.setWidth("100.0%");
        layoutPunctElbow.setHeight("-1px");
        layoutPunctElbow.setMargin(false);
        layoutPunctElbow.setSpacing(true);
        
        // labelElbow
        labelElbow = new Label();
        labelElbow.setImmediate(false);
        labelElbow.setWidth("-1px");
        labelElbow.setHeight("-1px");
        labelElbow.setValue("Ellenbeuge");
        layoutPunctElbow.addComponent(labelElbow);
        layoutPunctElbow.setExpandRatio(labelElbow, 1.0f);
        
        // elbowLeft
        elbowLeft = new CheckBox();
        elbowLeft.setCaption("links");
        elbowLeft.setImmediate(false);
        elbowLeft.setWidth("-1px");
        elbowLeft.setHeight("-1px");
        layoutPunctElbow.addComponent(elbowLeft);
        
        // elbowRight
        elbowRight = new CheckBox();
        elbowRight.setCaption("rechts");
        elbowRight.setImmediate(false);
        elbowRight.setWidth("-1px");
        elbowRight.setHeight("-1px");
        layoutPunctElbow.addComponent(elbowRight);
        
        return layoutPunctElbow;
    }

    @AutoGenerated
    private HorizontalLayout buildLayoutPunctHand() {
        // common part: create layout
        layoutPunctHand = new HorizontalLayout();
        layoutPunctHand.setImmediate(false);
        layoutPunctHand.setWidth("100.0%");
        layoutPunctHand.setHeight("-1px");
        layoutPunctHand.setMargin(false);
        layoutPunctHand.setSpacing(true);
        
        // labelHand
        labelHand = new Label();
        labelHand.setImmediate(false);
        labelHand.setWidth("-1px");
        labelHand.setHeight("-1px");
        labelHand.setValue("Handrücken");
        layoutPunctHand.addComponent(labelHand);
        layoutPunctHand.setExpandRatio(labelHand, 1.0f);
        
        // handLeft
        handLeft = new CheckBox();
        handLeft.setCaption("links");
        handLeft.setImmediate(false);
        handLeft.setWidth("-1px");
        handLeft.setHeight("-1px");
        layoutPunctHand.addComponent(handLeft);
        
        // handRight
        handRight = new CheckBox();
        handRight.setCaption("rechts");
        handRight.setImmediate(false);
        handRight.setWidth("-1px");
        handRight.setHeight("-1px");
        layoutPunctHand.addComponent(handRight);
        
        return layoutPunctHand;
    }

    @AutoGenerated
    private HorizontalLayout buildLayoutPunctArm() {
        // common part: create layout
        layoutPunctArm = new HorizontalLayout();
        layoutPunctArm.setImmediate(false);
        layoutPunctArm.setWidth("100.0%");
        layoutPunctArm.setHeight("-1px");
        layoutPunctArm.setMargin(false);
        layoutPunctArm.setSpacing(true);
        
        // labelArm
        labelArm = new Label();
        labelArm.setImmediate(false);
        labelArm.setWidth("-1px");
        labelArm.setHeight("-1px");
        labelArm.setValue("Unterarm");
        layoutPunctArm.addComponent(labelArm);
        layoutPunctArm.setExpandRatio(labelArm, 1.0f);
        
        // armLeft
        armLeft = new CheckBox();
        armLeft.setCaption("links");
        armLeft.setImmediate(false);
        armLeft.setWidth("-1px");
        armLeft.setHeight("-1px");
        layoutPunctArm.addComponent(armLeft);
        
        // armRight
        armRight = new CheckBox();
        armRight.setCaption("rechts");
        armRight.setImmediate(false);
        armRight.setWidth("-1px");
        armRight.setHeight("-1px");
        layoutPunctArm.addComponent(armRight);
        
        return layoutPunctArm;
    }

    @AutoGenerated
    private VerticalLayout buildLayoutPunctPortACath() {
        // common part: create layout
        layoutPunctPortACath = new VerticalLayout();
        layoutPunctPortACath.setImmediate(false);
        layoutPunctPortACath.setWidth("100.0%");
        layoutPunctPortACath.setHeight("-1px");
        layoutPunctPortACath.setMargin(false);
        
        // horizontalLayout_12
        horizontalLayout_12 = buildHorizontalLayout_12();
        layoutPunctPortACath.addComponent(horizontalLayout_12);
        
        // horizontalLayout_15
        horizontalLayout_15 = buildHorizontalLayout_15();
        layoutPunctPortACath.addComponent(horizontalLayout_15);
        
        return layoutPunctPortACath;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_12() {
        // common part: create layout
        horizontalLayout_12 = new HorizontalLayout();
        horizontalLayout_12.setImmediate(false);
        horizontalLayout_12.setWidth("100.0%");
        horizontalLayout_12.setHeight("-1px");
        horizontalLayout_12.setMargin(false);
        horizontalLayout_12.setSpacing(true);
        
        // portACath
        portACath = new CheckBox();
        portACath.setCaption("Port-A-Cath");
        portACath.setImmediate(false);
        portACath.setWidth("-1px");
        portACath.setHeight("-1px");
        horizontalLayout_12.addComponent(portACath);
        horizontalLayout_12.setExpandRatio(portACath, 1.0f);
        
        // portACathLeft
        portACathLeft = new CheckBox();
        portACathLeft.setCaption("links");
        portACathLeft.setImmediate(false);
        portACathLeft.setWidth("-1px");
        portACathLeft.setHeight("-1px");
        horizontalLayout_12.addComponent(portACathLeft);
        
        // portACathRight
        portACathRight = new CheckBox();
        portACathRight.setCaption("rechts");
        portACathRight.setImmediate(false);
        portACathRight.setWidth("-1px");
        portACathRight.setHeight("-1px");
        horizontalLayout_12.addComponent(portACathRight);
        
        return horizontalLayout_12;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_15() {
        // common part: create layout
        horizontalLayout_15 = new HorizontalLayout();
        horizontalLayout_15.setImmediate(false);
        horizontalLayout_15.setWidth("-1px");
        horizontalLayout_15.setHeight("-1px");
        horizontalLayout_15.setMargin(false);
        horizontalLayout_15.setSpacing(true);
        
        // portACathNew
        portACathNew = new CheckBox();
        portACathNew.setCaption("neu");
        portACathNew.setImmediate(false);
        portACathNew.setWidth("-1px");
        portACathNew.setHeight("-1px");
        horizontalLayout_15.addComponent(portACathNew);
        
        // portACathReady
        portACathReady = new CheckBox();
        portACathReady.setCaption("liegend");
        portACathReady.setImmediate(false);
        portACathReady.setWidth("-1px");
        portACathReady.setHeight("-1px");
        horizontalLayout_15.addComponent(portACathReady);
        
        return horizontalLayout_15;
    }

    @AutoGenerated
    private HorizontalLayout buildLayoutMainMedInfo() {
        // common part: create layout
        layoutMainMedInfo = new HorizontalLayout();
        layoutMainMedInfo.setStyleName("cust_margin_half_full_none_full");
        layoutMainMedInfo.setImmediate(false);
        layoutMainMedInfo.setWidth("100.0%");
        layoutMainMedInfo.setHeight("-1px");
        layoutMainMedInfo.setMargin(true);
        layoutMainMedInfo.setSpacing(true);
        
        // layoutMainMedInfoleft
        layoutMainMedInfoleft = buildLayoutMainMedInfoleft();
        layoutMainMedInfo.addComponent(layoutMainMedInfoleft);
        
        // layoutMainMedInfoRight
        layoutMainMedInfoRight = buildLayoutMainMedInfoRight();
        layoutMainMedInfo.addComponent(layoutMainMedInfoRight);
        
        return layoutMainMedInfo;
    }

    @AutoGenerated
    private VerticalLayout buildLayoutMainMedInfoleft() {
        // common part: create layout
        layoutMainMedInfoleft = new VerticalLayout();
        layoutMainMedInfoleft.setImmediate(false);
        layoutMainMedInfoleft.setWidth("100.0%");
        layoutMainMedInfoleft.setHeight("-1px");
        layoutMainMedInfoleft.setMargin(false);
        layoutMainMedInfoleft.setSpacing(true);
        
        // horizontalLayout_19
        horizontalLayout_19 = buildHorizontalLayout_19();
        layoutMainMedInfoleft.addComponent(horizontalLayout_19);
        
        // horizontalLayout_20
        horizontalLayout_20 = buildHorizontalLayout_20();
        layoutMainMedInfoleft.addComponent(horizontalLayout_20);
        
        // mainMedVolume
        mainMedVolume = new FloatStepper();
        mainMedVolume.setCaption("Medikamentenvolumen");
        mainMedVolume.setImmediate(false);
        mainMedVolume.setWidth("-1px");
        mainMedVolume.setHeight("-1px");
        layoutMainMedInfoleft.addComponent(mainMedVolume);
        
        // mainMedFlush
        mainMedFlush = new FloatStepper();
        mainMedFlush.setCaption("Spüllösung (vor & nach Inf.)");
        mainMedFlush.setImmediate(false);
        mainMedFlush.setWidth("-1px");
        mainMedFlush.setHeight("-1px");
        layoutMainMedInfoleft.addComponent(mainMedFlush);
        
        return layoutMainMedInfoleft;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_19() {
        // common part: create layout
        horizontalLayout_19 = new HorizontalLayout();
        horizontalLayout_19.setImmediate(false);
        horizontalLayout_19.setWidth("100.0%");
        horizontalLayout_19.setHeight("-1px");
        horizontalLayout_19.setMargin(false);
        horizontalLayout_19.setSpacing(true);
        
        // mainMedName
        mainMedName = new TextField();
        mainMedName.setCaption("Hauptmedikament");
        mainMedName.setImmediate(false);
        mainMedName.setWidth("100.0%");
        mainMedName.setHeight("-1px");
        horizontalLayout_19.addComponent(mainMedName);
        horizontalLayout_19.setExpandRatio(mainMedName, 1.0f);
        
        // mainMedDosage
        mainMedDosage = new FloatStepper();
        mainMedDosage.setCaption("verabr.");
        mainMedDosage.setImmediate(false);
        mainMedDosage.setWidth("80px");
        mainMedDosage.setHeight("-1px");
        horizontalLayout_19.addComponent(mainMedDosage);
        
        // mainMedDosageUnitLabel
        mainMedDosageUnitLabel = new Label();
        mainMedDosageUnitLabel.setImmediate(false);
        mainMedDosageUnitLabel.setWidth("40px");
        mainMedDosageUnitLabel.setHeight("-1px");
        mainMedDosageUnitLabel.setValue("unit");
        horizontalLayout_19.addComponent(mainMedDosageUnitLabel);
        horizontalLayout_19.setComponentAlignment(mainMedDosageUnitLabel, new Alignment(48));
        
        return horizontalLayout_19;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_20() {
        // common part: create layout
        horizontalLayout_20 = new HorizontalLayout();
        horizontalLayout_20.setImmediate(false);
        horizontalLayout_20.setWidth("100.0%");
        horizontalLayout_20.setHeight("-1px");
        horizontalLayout_20.setMargin(false);
        horizontalLayout_20.setSpacing(true);
        
        // mainMedSolvent
        mainMedSolvent = new ComboBox();
        mainMedSolvent.setCaption("Medikament gelöst");
        mainMedSolvent.setImmediate(false);
        mainMedSolvent.setWidth("100.0%");
        mainMedSolvent.setHeight("-1px");
        horizontalLayout_20.addComponent(mainMedSolvent);
        horizontalLayout_20.setExpandRatio(mainMedSolvent, 1.0f);
        
        // mainMedSolventVolume
        mainMedSolventVolume = new FloatStepper();
        mainMedSolventVolume.setCaption("ml");
        mainMedSolventVolume.setImmediate(false);
        mainMedSolventVolume.setWidth("80px");
        mainMedSolventVolume.setHeight("-1px");
        horizontalLayout_20.addComponent(mainMedSolventVolume);
        
        return horizontalLayout_20;
    }

    @AutoGenerated
    private VerticalLayout buildLayoutMainMedInfoRight() {
        // common part: create layout
        layoutMainMedInfoRight = new VerticalLayout();
        layoutMainMedInfoRight.setImmediate(false);
        layoutMainMedInfoRight.setWidth("100.0%");
        layoutMainMedInfoRight.setHeight("-1px");
        layoutMainMedInfoRight.setMargin(false);
        layoutMainMedInfoRight.setSpacing(true);
        
        // layout_port
        layout_port = buildLayout_port();
        layoutMainMedInfoRight.addComponent(layout_port);
        
        // punctComment
        punctComment = new TextField();
        punctComment.setCaption("zusätzliche Angaben");
        punctComment.setImmediate(false);
        punctComment.setWidth("100.0%");
        punctComment.setHeight("-1px");
        layoutMainMedInfoRight.addComponent(punctComment);
        
        // layoutCount
        layoutCount = buildLayoutCount();
        layoutMainMedInfoRight.addComponent(layoutCount);
        
        // mainMedTotalVolume
        mainMedTotalVolume = new FloatStepper();
        mainMedTotalVolume.setCaption("Gesamtinfusionsvolumen");
        mainMedTotalVolume.setImmediate(false);
        mainMedTotalVolume.setWidth("-1px");
        mainMedTotalVolume.setHeight("-1px");
        layoutMainMedInfoRight.addComponent(mainMedTotalVolume);
        
        return layoutMainMedInfoRight;
    }

    @AutoGenerated
    private HorizontalLayout buildLayout_port() {
        // common part: create layout
        layout_port = new HorizontalLayout();
        layout_port.setImmediate(false);
        layout_port.setWidth("100.0%");
        layout_port.setHeight("-1px");
        layout_port.setMargin(false);
        layout_port.setSpacing(true);
        
        // punctPortBlock
        punctPortBlock = new TextField();
        punctPortBlock.setCaption("Port: Block");
        punctPortBlock.setImmediate(false);
        punctPortBlock.setWidth("100.0%");
        punctPortBlock.setHeight("-1px");
        layout_port.addComponent(punctPortBlock);
        
        // punctPortDetails
        punctPortDetails = new TextField();
        punctPortDetails.setCaption("Port: Details");
        punctPortDetails.setImmediate(false);
        punctPortDetails.setWidth("100.0%");
        punctPortDetails.setHeight("-1px");
        layout_port.addComponent(punctPortDetails);
        
        return layout_port;
    }

    @AutoGenerated
    private HorizontalLayout buildLayoutCount() {
        // common part: create layout
        layoutCount = new HorizontalLayout();
        layoutCount.setImmediate(false);
        layoutCount.setWidth("100.0%");
        layoutCount.setHeight("-1px");
        layoutCount.setMargin(false);
        layoutCount.setSpacing(true);
        
        // mainMedCount
        mainMedCount = new IntStepper();
        mainMedCount.setCaption("Ampullen");
        mainMedCount.setImmediate(false);
        mainMedCount.setWidth("-1px");
        mainMedCount.setHeight("-1px");
        layoutCount.addComponent(mainMedCount);
        
        // productSource
        productSource = new InfusionProductSource();
        productSource.setCaption("Produktquelle");
        productSource.setImmediate(false);
        productSource.setWidth("-1px");
        productSource.setHeight("-1px");
        layoutCount.addComponent(productSource);
        
        return layoutCount;
    }

    @AutoGenerated
    private VerticalLayout buildLayoutCharges() {
        // common part: create layout
        layoutCharges = new VerticalLayout();
        layoutCharges.setImmediate(false);
        layoutCharges.setWidth("100.0%");
        layoutCharges.setHeight("100.0%");
        layoutCharges.setMargin(false);
        
        // panelCharges
        panelCharges = new PanelCharges();
        panelCharges.setImmediate(false);
        panelCharges.setWidth("100.0%");
        panelCharges.setHeight("100.0%");
        layoutCharges.addComponent(panelCharges);
        
        return layoutCharges;
    }

    @AutoGenerated
    private VerticalLayout buildLayoutTimes() {
        // common part: create layout
        layoutTimes = new VerticalLayout();
        layoutTimes.setImmediate(false);
        layoutTimes.setWidth("100.0%");
        layoutTimes.setHeight("100.0%");
        layoutTimes.setMargin(false);
        
        // panelInfusionTimes
        panelInfusionTimes = new PanelInfusionTimes();
        panelInfusionTimes.setImmediate(false);
        panelInfusionTimes.setWidth("100.0%");
        panelInfusionTimes.setHeight("100.0%");
        layoutTimes.addComponent(panelInfusionTimes);
        
        return layoutTimes;
    }

    @AutoGenerated
    private VerticalLayout buildLayoutVitals() {
        // common part: create layout
        layoutVitals = new VerticalLayout();
        layoutVitals.setImmediate(false);
        layoutVitals.setWidth("100.0%");
        layoutVitals.setHeight("100.0%");
        layoutVitals.setMargin(false);
        
        // panelVitals
        panelVitals = new PanelVitals();
        panelVitals.setImmediate(false);
        panelVitals.setWidth("100.0%");
        panelVitals.setHeight("100.0%");
        layoutVitals.addComponent(panelVitals);
        
        return layoutVitals;
    }

    @AutoGenerated
    private VerticalLayout buildLayoutPostmed() {
        // common part: create layout
        layoutPostmed = new VerticalLayout();
        layoutPostmed.setImmediate(false);
        layoutPostmed.setWidth("100.0%");
        layoutPostmed.setHeight("100.0%");
        layoutPostmed.setMargin(false);
        
        // panelPostMed
        panelPostMed = new PanelPostMed();
        panelPostMed.setImmediate(false);
        panelPostMed.setWidth("100.0%");
        panelPostMed.setHeight("100.0%");
        layoutPostmed.addComponent(panelPostMed);
        
        return layoutPostmed;
    }

    @AutoGenerated
    private VerticalLayout buildVl_events() {
        // common part: create layout
        vl_events = new VerticalLayout();
        vl_events.setImmediate(false);
        vl_events.setWidth("100.0%");
        vl_events.setHeight("100.0%");
        vl_events.setMargin(true);
        vl_events.setSpacing(true);
        
        // horizontalLayout_18
        horizontalLayout_18 = buildHorizontalLayout_18();
        vl_events.addComponent(horizontalLayout_18);
        vl_events.setExpandRatio(horizontalLayout_18, 3.0f);
        
        // horizontalLayout_21
        horizontalLayout_21 = buildHorizontalLayout_21();
        vl_events.addComponent(horizontalLayout_21);
        vl_events.setExpandRatio(horizontalLayout_21, 3.0f);
        vl_events.setComponentAlignment(horizontalLayout_21, new Alignment(9));
        
        // horizontalLayout_22
        horizontalLayout_22 = buildHorizontalLayout_22();
        vl_events.addComponent(horizontalLayout_22);
        vl_events.setExpandRatio(horizontalLayout_22, 1.0f);
        
        return vl_events;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_18() {
        // common part: create layout
        horizontalLayout_18 = new HorizontalLayout();
        horizontalLayout_18.setImmediate(false);
        horizontalLayout_18.setWidth("100.0%");
        horizontalLayout_18.setHeight("100.0%");
        horizontalLayout_18.setMargin(false);
        horizontalLayout_18.setSpacing(true);
        
        // verticalLayout_15
        verticalLayout_15 = buildVerticalLayout_15();
        horizontalLayout_18.addComponent(verticalLayout_15);
        horizontalLayout_18.setComponentAlignment(verticalLayout_15, new Alignment(33));
        
        // ta_reaction_today_desc
        ta_reaction_today_desc = new TextArea();
        ta_reaction_today_desc.setCaption("Beschreibung");
        ta_reaction_today_desc.setImmediate(false);
        ta_reaction_today_desc.setWidth("90.0%");
        ta_reaction_today_desc.setHeight("-1px");
        horizontalLayout_18.addComponent(ta_reaction_today_desc);
        horizontalLayout_18.setExpandRatio(ta_reaction_today_desc, 1.0f);
        horizontalLayout_18.setComponentAlignment(ta_reaction_today_desc, new Alignment(48));
        
        return horizontalLayout_18;
    }

    @AutoGenerated
    private VerticalLayout buildVerticalLayout_15() {
        // common part: create layout
        verticalLayout_15 = new VerticalLayout();
        verticalLayout_15.setImmediate(false);
        verticalLayout_15.setWidth("330px");
        verticalLayout_15.setHeight("-1px");
        verticalLayout_15.setMargin(false);
        verticalLayout_15.setSpacing(true);
        
        // lbl_reaction_today
        lbl_reaction_today = new Label();
        lbl_reaction_today.setStyleName("v-panel-caption");
        lbl_reaction_today.setImmediate(false);
        lbl_reaction_today.setWidth("-1px");
        lbl_reaction_today.setHeight("-1px");
        lbl_reaction_today.setValue("Traten heute infusionsbedingte Reaktionen auf?");
        verticalLayout_15.addComponent(lbl_reaction_today);
        
        // ns_reaction_today
        ns_reaction_today = new NativeSelect();
        ns_reaction_today.setImmediate(false);
        ns_reaction_today.setWidth("-1px");
        ns_reaction_today.setHeight("-1px");
        verticalLayout_15.addComponent(ns_reaction_today);
        
        // cbx_reaction_today_intensity
        cbx_reaction_today_intensity = new ComboBox();
        cbx_reaction_today_intensity.setCaption("Intensitätsgrad");
        cbx_reaction_today_intensity.setImmediate(false);
        cbx_reaction_today_intensity.setWidth("-1px");
        cbx_reaction_today_intensity.setHeight("-1px");
        verticalLayout_15.addComponent(cbx_reaction_today_intensity);
        
        return verticalLayout_15;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_21() {
        // common part: create layout
        horizontalLayout_21 = new HorizontalLayout();
        horizontalLayout_21.setImmediate(false);
        horizontalLayout_21.setWidth("100.0%");
        horizontalLayout_21.setHeight("100.0%");
        horizontalLayout_21.setMargin(false);
        horizontalLayout_21.setSpacing(true);
        
        // verticalLayout_17
        verticalLayout_17 = buildVerticalLayout_17();
        horizontalLayout_21.addComponent(verticalLayout_17);
        horizontalLayout_21.setComponentAlignment(verticalLayout_17, new Alignment(33));
        
        // ta_reaction_recent_desc
        ta_reaction_recent_desc = new TextArea();
        ta_reaction_recent_desc.setCaption("Beschreibung");
        ta_reaction_recent_desc.setImmediate(false);
        ta_reaction_recent_desc.setWidth("90.0%");
        ta_reaction_recent_desc.setHeight("-1px");
        horizontalLayout_21.addComponent(ta_reaction_recent_desc);
        horizontalLayout_21.setExpandRatio(ta_reaction_recent_desc, 1.0f);
        horizontalLayout_21.setComponentAlignment(ta_reaction_recent_desc, new Alignment(48));
        
        return horizontalLayout_21;
    }

    @AutoGenerated
    private VerticalLayout buildVerticalLayout_17() {
        // common part: create layout
        verticalLayout_17 = new VerticalLayout();
        verticalLayout_17.setImmediate(false);
        verticalLayout_17.setWidth("330px");
        verticalLayout_17.setHeight("-1px");
        verticalLayout_17.setMargin(false);
        verticalLayout_17.setSpacing(true);
        
        // lbl_reaction_recent
        lbl_reaction_recent = new Label();
        lbl_reaction_recent.setStyleName("v-panel-caption");
        lbl_reaction_recent.setImmediate(false);
        lbl_reaction_recent.setWidth("300px");
        lbl_reaction_recent.setHeight("-1px");
        lbl_reaction_recent.setValue("Traten im zurückliegenden Zeitraum zur letzten Infusion unerwünschte Ereignisse auf?");
        verticalLayout_17.addComponent(lbl_reaction_recent);
        
        // ns_reaction_recent
        ns_reaction_recent = new NativeSelect();
        ns_reaction_recent.setImmediate(false);
        ns_reaction_recent.setWidth("-1px");
        ns_reaction_recent.setHeight("-1px");
        verticalLayout_17.addComponent(ns_reaction_recent);
        
        // cbx_reaction_recent_intensity
        cbx_reaction_recent_intensity = new ComboBox();
        cbx_reaction_recent_intensity.setCaption("Intensitätsgrad");
        cbx_reaction_recent_intensity.setImmediate(false);
        cbx_reaction_recent_intensity.setWidth("-1px");
        cbx_reaction_recent_intensity.setHeight("-1px");
        verticalLayout_17.addComponent(cbx_reaction_recent_intensity);
        
        return verticalLayout_17;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_22() {
        // common part: create layout
        horizontalLayout_22 = new HorizontalLayout();
        horizontalLayout_22.setImmediate(false);
        horizontalLayout_22.setWidth("100.0%");
        horizontalLayout_22.setHeight("-1px");
        horizontalLayout_22.setMargin(false);
        
        // causedBy
        causedBy = new BooleanComboBox();
        causedBy.setCaption("causedBy");
        causedBy.setImmediate(false);
        causedBy.setWidth("-1px");
        causedBy.setHeight("-1px");
        horizontalLayout_22.addComponent(causedBy);
        
        // correlation
        correlation = new ComboBox();
        correlation.setCaption("correlation");
        correlation.setImmediate(false);
        correlation.setWidth("-1px");
        correlation.setHeight("-1px");
        horizontalLayout_22.addComponent(correlation);
        
        return horizontalLayout_22;
    }

    @AutoGenerated
    private VerticalLayout buildVl_comments() {
        // common part: create layout
        vl_comments = new VerticalLayout();
        vl_comments.setCaption("Kommentare");
        vl_comments.setImmediate(false);
        vl_comments.setWidth("100.0%");
        vl_comments.setHeight("100.0%");
        vl_comments.setMargin(true);
        vl_comments.setSpacing(true);
        
        // txta_beobachtungen
        txta_beobachtungen = new TextArea();
        txta_beobachtungen.setStyleName("cust_textarea_no_margin");
        txta_beobachtungen.setCaption("Beobachtungen");
        txta_beobachtungen.setImmediate(false);
        txta_beobachtungen.setWidth("100.0%");
        txta_beobachtungen.setHeight("100.0%");
        vl_comments.addComponent(txta_beobachtungen);
        
        // txta_bemerkungen
        txta_bemerkungen = new TextArea();
        txta_bemerkungen.setStyleName("cust_textarea_no_margin");
        txta_bemerkungen.setCaption("Bemerkungen");
        txta_bemerkungen.setImmediate(false);
        txta_bemerkungen.setWidth("100.0%");
        txta_bemerkungen.setHeight("100.0%");
        vl_comments.addComponent(txta_bemerkungen);
        
        return vl_comments;
    }

    @AutoGenerated
    private HorizontalLayout buildHorizontalLayout_4() {
        // common part: create layout
        horizontalLayout_4 = new HorizontalLayout();
        horizontalLayout_4.setImmediate(false);
        horizontalLayout_4.setWidth("100.0%");
        horizontalLayout_4.setHeight("40px");
        horizontalLayout_4.setMargin(false);
        
        // btn_save
        btn_save = new Button();
        btn_save.setCaption("Speichern");
        btn_save.setImmediate(true);
        btn_save.setWidth("-1px");
        btn_save.setHeight("-1px");
        horizontalLayout_4.addComponent(btn_save);
        horizontalLayout_4.setComponentAlignment(btn_save, new Alignment(48));
        
        return horizontalLayout_4;
    }

    @AutoGenerated
    private AbsoluteLayout buildAl_localization_labels() {
        // common part: create layout
        al_localization_labels = new AbsoluteLayout();
        al_localization_labels.setEnabled(false);
        al_localization_labels.setImmediate(false);
        al_localization_labels.setVisible(false);
        al_localization_labels.setWidth("-1px");
        al_localization_labels.setHeight("-1px");
        
        // lbl_no
        lbl_no = new Label();
        lbl_no.setCaption("Nein");
        lbl_no.setEnabled(false);
        lbl_no.setImmediate(false);
        lbl_no.setVisible(false);
        lbl_no.setWidth("-1px");
        lbl_no.setHeight("-1px");
        lbl_no.setValue("0");
        al_localization_labels.addComponent(lbl_no, "top:0.0px;left:0.0px;");
        
        // lbl_yes
        lbl_yes = new Label();
        lbl_yes.setCaption("Ja");
        lbl_yes.setEnabled(false);
        lbl_yes.setImmediate(false);
        lbl_yes.setVisible(false);
        lbl_yes.setWidth("-1px");
        lbl_yes.setHeight("-1px");
        lbl_yes.setValue("1");
        al_localization_labels.addComponent(lbl_yes, "top:0.0px;left:0.0px;");
        
        return al_localization_labels;
    }

    @AutoGenerated
    private AbsoluteLayout buildAl_passive_fields() {
        // common part: create layout
        al_passive_fields = new AbsoluteLayout();
        al_passive_fields.setEnabled(false);
        al_passive_fields.setImmediate(false);
        al_passive_fields.setVisible(false);
        al_passive_fields.setWidth("-1px");
        al_passive_fields.setHeight("-1px");
        
        // fieldBalanceWasRemoved
        fieldBalanceWasRemoved = new IntStepper();
        fieldBalanceWasRemoved.setEnabled(false);
        fieldBalanceWasRemoved.setImmediate(false);
        fieldBalanceWasRemoved.setVisible(false);
        fieldBalanceWasRemoved.setWidth("-1px");
        fieldBalanceWasRemoved.setHeight("-1px");
        al_passive_fields.addComponent(fieldBalanceWasRemoved, "top:0.0px;left:0.0px;");
        
        return al_passive_fields;
    }

}
